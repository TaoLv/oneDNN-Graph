<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>oneDNN Graph: cpu_simple_pattern_tiny.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script src="assets/mathjax/MathJax.js?config=TeX-AMS_CHTML,dnnl"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="assets/customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="assets/dnn.js"></script>
</head>
<body>
<div class="mobile-nav"><i id="nav-btn"></i><a href="index.html">oneAPI Deep Neural Network Library Graph API (oneDNN Graph)</a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname">
     <a href="index.html">
      <div id="full-name">oneAPI Deep Neural Network Library Graph API (oneDNN Graph)</div>
    </a>
   </div>
   <div id="projectbrief">Performance Library for DNN Graph Optimization</div>
   <div id="projectnumber">0.4.3</div>
  <div>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('cpu_simple_pattern_tiny_8c-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">cpu_simple_pattern_tiny.c</div>  </div>
</div><!--header-->
<div class="contents">
<blockquote class="doxtable">
<p>Example code: <a class="el" href="cpu_simple_pattern_tiny_8c-example.html">cpu_simple_pattern_tiny.c</a> </p>
</blockquote>
<blockquote class="doxtable">
<p>Annotated version: <a class="el" href="cpu_simple_pattern_tiny_c.html">A tiny CPU example for conv+bias+relu+conv+bias+relu pattern</a> </p>
</blockquote>
<div class="fragment"><div class="line"><span class="comment">/*******************************************************************************</span></div>
<div class="line"><span class="comment">* Copyright 2020-2021 Intel Corporation</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><span class="comment">* you may not use this file except in compliance with the License.</span></div>
<div class="line"><span class="comment">* You may obtain a copy of the License at</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*     http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><span class="comment">* distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><span class="comment">* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><span class="comment">* See the License for the specific language governing permissions and</span></div>
<div class="line"><span class="comment">* limitations under the License.</span></div>
<div class="line"><span class="comment">*******************************************************************************/</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;common/allocator.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;common/utils.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="dnnl__graph_8h.html">oneapi/dnnl/dnnl_graph.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//    0 (conv0_src)</span></div>
<div class="line"><span class="comment">//    |    1 (conv0_weight)</span></div>
<div class="line"><span class="comment">//    |   /</span></div>
<div class="line"><span class="comment">//    |  /</span></div>
<div class="line"><span class="comment">//   op0 (conv0)                ---</span></div>
<div class="line"><span class="comment">//    |       2 (conv0_bias)      |</span></div>
<div class="line"><span class="comment">//    |     /                     |</span></div>
<div class="line"><span class="comment">//   op4 (bias_add0)              |</span></div>
<div class="line"><span class="comment">//    |                           | partition 0</span></div>
<div class="line"><span class="comment">//    |                           |</span></div>
<div class="line"><span class="comment">//    3 (bias_add0_dst/relu0_src) |</span></div>
<div class="line"><span class="comment">//    |                           |</span></div>
<div class="line"><span class="comment">//   op1 (relu0)                ---</span></div>
<div class="line"><span class="comment">//    |</span></div>
<div class="line"><span class="comment">//    4 (relu0_dst/conv1_src)</span></div>
<div class="line"><span class="comment">//    |    5 (conv1_weight)</span></div>
<div class="line"><span class="comment">//    |   /</span></div>
<div class="line"><span class="comment">//    |  /</span></div>
<div class="line"><span class="comment">//   op2 (conv1)                ---</span></div>
<div class="line"><span class="comment">//    |       6 (conv1_bias)      |</span></div>
<div class="line"><span class="comment">//    |     /                     |</span></div>
<div class="line"><span class="comment">//   op5 (bias_add1)              |</span></div>
<div class="line"><span class="comment">//    |                           | partition 1</span></div>
<div class="line"><span class="comment">//    |                           |</span></div>
<div class="line"><span class="comment">//    7 (bias_add1_dst/relu1_src) |</span></div>
<div class="line"><span class="comment">//    |                           |</span></div>
<div class="line"><span class="comment">//   op3 (relu1)                ---</span></div>
<div class="line"><span class="comment">//    |</span></div>
<div class="line"><span class="comment">//    8 (relu1-dst)</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">// Pre-define unique id for dnnl_graph_op,</span></div>
<div class="line"><span class="comment">// used to represent op in computation graph</span></div>
<div class="line"><span class="preprocessor">#define CONV0_ID 0</span></div>
<div class="line"><span class="preprocessor">#define RELU0_ID 1</span></div>
<div class="line"><span class="preprocessor">#define CONV1_ID 2</span></div>
<div class="line"><span class="preprocessor">#define RELU1_ID 3</span></div>
<div class="line"><span class="preprocessor">#define BIAS_ADD0_ID 4</span></div>
<div class="line"><span class="preprocessor">#define BIAS_ADD1_ID 5</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Predefine unique id for dnnl_graph_logical_tensor,</span></div>
<div class="line"><span class="comment">// used to represent edge in computation graph</span></div>
<div class="line"><span class="preprocessor">#define CONV0_SRC_ID 0</span></div>
<div class="line"><span class="preprocessor">#define CONV0_WEI_ID 1</span></div>
<div class="line"><span class="preprocessor">#define CONV0_BIAS_ID 2</span></div>
<div class="line"><span class="preprocessor">#define CONV0_DST_ID 3</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define RELU0_SRC_ID 3</span></div>
<div class="line"><span class="preprocessor">#define RELU0_DST_ID 4</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONV1_SRC_ID 4</span></div>
<div class="line"><span class="preprocessor">#define CONV1_WEI_ID 5</span></div>
<div class="line"><span class="preprocessor">#define CONV1_BIAS_ID 6</span></div>
<div class="line"><span class="preprocessor">#define CONV1_DST_ID 7</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define RELU1_SRC_ID 7</span></div>
<div class="line"><span class="preprocessor">#define RELU1_DST_ID 8</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define BIAS_ADD0_DST_ID 9</span></div>
<div class="line"><span class="preprocessor">#define BIAS_ADD1_DST_ID 10</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// pre-defined net parameters</span></div>
<div class="line"><span class="preprocessor">#define BATCH 8</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONV0_IC 3</span></div>
<div class="line"><span class="preprocessor">#define CONV0_OC 96</span></div>
<div class="line"><span class="preprocessor">#define CONV0_IH 227</span></div>
<div class="line"><span class="preprocessor">#define CONV0_IW 227</span></div>
<div class="line"><span class="preprocessor">#define CONV0_OH 55</span></div>
<div class="line"><span class="preprocessor">#define CONV0_OW 55</span></div>
<div class="line"><span class="preprocessor">#define CONV0_KS 11</span></div>
<div class="line"><span class="preprocessor">#define CONV0_STRIDE 4</span></div>
<div class="line"><span class="preprocessor">#define CONV0_PADDING 0</span></div>
<div class="line"><span class="preprocessor">#define CONV0_DILATIONS 1</span></div>
<div class="line"><span class="preprocessor">#define CONV0_GROUPS 1</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONV1_IC 96</span></div>
<div class="line"><span class="preprocessor">#define CONV1_OC 96</span></div>
<div class="line"><span class="preprocessor">#define CONV1_IH 55</span></div>
<div class="line"><span class="preprocessor">#define CONV1_IW 55</span></div>
<div class="line"><span class="preprocessor">#define CONV1_OH 55</span></div>
<div class="line"><span class="preprocessor">#define CONV1_OW 55</span></div>
<div class="line"><span class="preprocessor">#define CONV1_KS 1</span></div>
<div class="line"><span class="preprocessor">#define CONV1_STRIDE 1</span></div>
<div class="line"><span class="preprocessor">#define CONV1_PADDING 0</span></div>
<div class="line"><span class="preprocessor">#define CONV1_DILATIONS 1</span></div>
<div class="line"><span class="preprocessor">#define CONV1_GROUPS 1</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__engine.html#ga6ac1ba87052e33099253f1d21ddd0091">dnnl_graph_engine_kind_t</a> engine_kind = parse_engine_kind(argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (engine_kind == <a name="a0"></a><a class="code" href="group__dnnl__graph__api__engine.html#gga6ac1ba87052e33099253f1d21ddd0091a0e4015e41880cfeee945c30cbf346da2">dnnl_graph_gpu</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Don&#39;t support gpu now\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 1: Create allocator----------------&quot;</span>);</div>
<div class="line">    dnnl_graph_allocator_t *allocator;</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a name="a1"></a><a class="code" href="group__dnnl__graph__api__allocator.html#ga72814446b3a0791919fc922ab5b84325">dnnl_graph_allocator_create</a>(&amp;allocator, allocate, deallocate));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 2: Create engine-------------------&quot;</span>);</div>
<div class="line">    dnnl_graph_engine_t *engine;</div>
<div class="line">    <span class="keyword">const</span> int32_t device_id = 0;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a2"></a><a class="code" href="group__dnnl__graph__api__engine.html#gaffbc76b0e5aaa1683475940224c7da2b">dnnl_graph_engine_create</a>(&amp;engine, engine_kind, device_id));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a3"></a><a class="code" href="group__dnnl__graph__api__engine.html#gae62032eb1c9997864d209de1023e2edd">dnnl_graph_engine_set_allocator</a>(engine, allocator));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 3: Create op-----------------------&quot;</span>);</div>
<div class="line">    dnnl_graph_op_t *conv0, *relu0, *conv1, *relu1, *bias_add0, *bias_add1;</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a name="a4"></a><a class="code" href="group__dnnl__graph__api__op.html#gaa04492222b1da2e74ed6c8e0e13d7ea3">dnnl_graph_op_create</a>(&amp;conv0, CONV0_ID, kConvolution, <span class="stringliteral">&quot;conv0&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaa04492222b1da2e74ed6c8e0e13d7ea3">dnnl_graph_op_create</a>(&amp;relu0, RELU0_ID, kReLU, <span class="stringliteral">&quot;relu0&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__op.html#gaa04492222b1da2e74ed6c8e0e13d7ea3">dnnl_graph_op_create</a>(&amp;conv1, CONV1_ID, kConvolution, <span class="stringliteral">&quot;conv1&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaa04492222b1da2e74ed6c8e0e13d7ea3">dnnl_graph_op_create</a>(&amp;relu1, RELU1_ID, kReLU, <span class="stringliteral">&quot;relu1&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaa04492222b1da2e74ed6c8e0e13d7ea3">dnnl_graph_op_create</a>(</div>
<div class="line">            &amp;bias_add0, BIAS_ADD0_ID, kBiasAdd, <span class="stringliteral">&quot;bias_add0&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaa04492222b1da2e74ed6c8e0e13d7ea3">dnnl_graph_op_create</a>(</div>
<div class="line">            &amp;bias_add1, BIAS_ADD1_ID, kBiasAdd, <span class="stringliteral">&quot;bias_add1&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    int64_t conv0_strides[] = {CONV0_STRIDE, CONV0_STRIDE};</div>
<div class="line">    int64_t conv0_padding[] = {CONV0_PADDING, CONV0_PADDING};</div>
<div class="line">    int64_t conv0_dilations[] = {CONV0_DILATIONS, CONV0_DILATIONS};</div>
<div class="line">    int64_t conv0_groups[] = {CONV0_GROUPS};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a5"></a><a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv0, <span class="stringliteral">&quot;strides&quot;</span>, <a name="a6"></a><a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc">dnnl_graph_attribute_kind_is</a>, conv0_strides, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(conv0, <span class="stringliteral">&quot;pads_begin&quot;</span>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc">dnnl_graph_attribute_kind_is</a>, conv0_padding, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv0, <span class="stringliteral">&quot;pads_end&quot;</span>, <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc">dnnl_graph_attribute_kind_is</a>, conv0_padding, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(conv0, <span class="stringliteral">&quot;dilations&quot;</span>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc">dnnl_graph_attribute_kind_is</a>, conv0_dilations, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv0, <span class="stringliteral">&quot;data_format&quot;</span>, <a name="a7"></a><a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa5f2ffc9a38e9d53cfe93fe94204489a4">dnnl_graph_attribute_kind_s</a>, <span class="stringliteral">&quot;NCX&quot;</span>, 1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv0, <span class="stringliteral">&quot;filter_format&quot;</span>, <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa5f2ffc9a38e9d53cfe93fe94204489a4">dnnl_graph_attribute_kind_s</a>, <span class="stringliteral">&quot;OIX&quot;</span>, 1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv0, <span class="stringliteral">&quot;groups&quot;</span>, <a name="a8"></a><a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa5c446fd6f0882f92546239ffddad2451">dnnl_graph_attribute_kind_i</a>, conv0_groups, 1));</div>
<div class="line"> </div>
<div class="line">    int64_t conv1_strides[] = {CONV1_STRIDE, CONV1_STRIDE};</div>
<div class="line">    int64_t conv1_padding[] = {CONV1_PADDING, CONV1_PADDING};</div>
<div class="line">    int64_t conv1_dilations[] = {CONV1_DILATIONS, CONV1_DILATIONS};</div>
<div class="line">    int64_t conv1_groups[] = {CONV1_GROUPS};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv1, <span class="stringliteral">&quot;strides&quot;</span>, <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc">dnnl_graph_attribute_kind_is</a>, conv1_strides, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(conv1, <span class="stringliteral">&quot;pads_begin&quot;</span>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc">dnnl_graph_attribute_kind_is</a>, conv1_padding, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv1, <span class="stringliteral">&quot;pads_end&quot;</span>, <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc">dnnl_graph_attribute_kind_is</a>, conv1_padding, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(conv1, <span class="stringliteral">&quot;dilations&quot;</span>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc">dnnl_graph_attribute_kind_is</a>, conv1_dilations, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv1, <span class="stringliteral">&quot;data_format&quot;</span>, <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa5f2ffc9a38e9d53cfe93fe94204489a4">dnnl_graph_attribute_kind_s</a>, <span class="stringliteral">&quot;NCX&quot;</span>, 1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv1, <span class="stringliteral">&quot;filter_format&quot;</span>, <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa5f2ffc9a38e9d53cfe93fe94204489a4">dnnl_graph_attribute_kind_s</a>, <span class="stringliteral">&quot;OIX&quot;</span>, 1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a>(</div>
<div class="line">            conv1, <span class="stringliteral">&quot;groups&quot;</span>, <a class="code" href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa5c446fd6f0882f92546239ffddad2451">dnnl_graph_attribute_kind_i</a>, conv1_groups, 1));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 4: Add OP to graph-----------------&quot;</span>);</div>
<div class="line">    dnnl_graph_graph_t *graph;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a9"></a><a class="code" href="group__dnnl__graph__api__graph.html#gadfe53f5827f6a1b22c6a3d379b229af9">dnnl_graph_graph_create</a>(&amp;graph, engine_kind));</div>
<div class="line">    {</div>
<div class="line">        <a name="_a10"></a><a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> conv0_src_desc, conv0_weight_desc,</div>
<div class="line">                conv0_bias_desc, conv0_dst_desc, relu0_src_desc, relu0_dst_desc,</div>
<div class="line">                conv1_src_desc, conv1_weight_desc, conv1_bias_desc,</div>
<div class="line">                conv1_dst_desc, relu1_src_desc, relu1_dst_desc,</div>
<div class="line">                bias_add0_dst_desc, bias_add1_dst_desc;</div>
<div class="line">        DNNL_GRAPH_CHECK(<a name="a11"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;conv0_src_desc,</div>
<div class="line">                CONV0_SRC_ID, <a name="a12"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a name="a13"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a name="a14"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;conv0_weight_desc,</div>
<div class="line">                CONV0_WEI_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;conv0_bias_desc,</div>
<div class="line">                CONV0_BIAS_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;conv0_dst_desc,</div>
<div class="line">                CONV0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;relu0_src_desc,</div>
<div class="line">                RELU0_SRC_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;relu0_dst_desc,</div>
<div class="line">                RELU0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;conv1_src_desc,</div>
<div class="line">                CONV1_SRC_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;conv1_weight_desc,</div>
<div class="line">                CONV1_WEI_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;conv1_bias_desc,</div>
<div class="line">                CONV1_BIAS_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;conv1_dst_desc,</div>
<div class="line">                CONV1_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;relu1_src_desc,</div>
<div class="line">                RELU1_SRC_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;relu1_dst_desc,</div>
<div class="line">                RELU1_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;bias_add0_dst_desc,</div>
<div class="line">                BIAS_ADD0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a>(&amp;bias_add1_dst_desc,</div>
<div class="line">                BIAS_ADD1_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line"> </div>
<div class="line">        DNNL_GRAPH_CHECK(<a name="a15"></a><a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(conv0, &amp;conv0_src_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(conv0, &amp;conv0_weight_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a name="a16"></a><a class="code" href="group__dnnl__graph__api__op.html#gaf57b836c94bc9974da2da67a0a68baf2">dnnl_graph_op_add_output</a>(conv0, &amp;conv0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(bias_add0, &amp;conv0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(bias_add0, &amp;conv0_bias_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaf57b836c94bc9974da2da67a0a68baf2">dnnl_graph_op_add_output</a>(bias_add0, &amp;bias_add0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(relu0, &amp;bias_add0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaf57b836c94bc9974da2da67a0a68baf2">dnnl_graph_op_add_output</a>(relu0, &amp;relu0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(conv1, &amp;relu0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(conv1, &amp;conv1_weight_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaf57b836c94bc9974da2da67a0a68baf2">dnnl_graph_op_add_output</a>(conv1, &amp;conv1_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(bias_add1, &amp;conv1_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(bias_add1, &amp;conv1_bias_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaf57b836c94bc9974da2da67a0a68baf2">dnnl_graph_op_add_output</a>(bias_add1, &amp;bias_add1_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a>(relu1, &amp;bias_add1_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaf57b836c94bc9974da2da67a0a68baf2">dnnl_graph_op_add_output</a>(relu1, &amp;relu1_dst_desc));</div>
<div class="line"> </div>
<div class="line">        DNNL_GRAPH_CHECK(<a name="a17"></a><a class="code" href="group__dnnl__graph__api__graph.html#ga46e3946d6079590f03205f660be1b5fe">dnnl_graph_add_op</a>(graph, conv0));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#ga46e3946d6079590f03205f660be1b5fe">dnnl_graph_add_op</a>(graph, bias_add0));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#ga46e3946d6079590f03205f660be1b5fe">dnnl_graph_add_op</a>(graph, relu0));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#ga46e3946d6079590f03205f660be1b5fe">dnnl_graph_add_op</a>(graph, conv1));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#ga46e3946d6079590f03205f660be1b5fe">dnnl_graph_add_op</a>(graph, bias_add1));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#ga46e3946d6079590f03205f660be1b5fe">dnnl_graph_add_op</a>(graph, relu1));</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 5: Filter and get partition--------&quot;</span>);</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a name="a18"></a><a class="code" href="group__dnnl__graph__api__graph.html#ga27e4c096e75702ef2a885c2cecd64d12">dnnl_graph_graph_filter</a>(graph, <a name="a19"></a><a class="code" href="group__dnnl__graph__api__partition.html#gga7e24b277b64600ef3a83dac2e8dfa83ba1489f3f9bb1262b58fa0bf0524d883a4">dnnl_graph_partition_policy_fusion</a>));</div>
<div class="line"> </div>
<div class="line">    uint64_t partitions_num;</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a name="a20"></a><a class="code" href="group__dnnl__graph__api__graph.html#gab0799273b35e51deb13ebaf510124a8b">dnnl_graph_graph_get_partition_num</a>(graph, &amp;partitions_num));</div>
<div class="line">    <span class="keywordflow">if</span> (partitions_num != 2) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: partitions number is not equal to %llu\n&quot;</span>,</div>
<div class="line">                (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>)partitions_num);</div>
<div class="line">        exit(1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    dnnl_graph_partition_t *partitions[2];</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a21"></a><a class="code" href="group__dnnl__graph__api__partition.html#gabdd1e8735d0f2f72165da4c2458121e0">dnnl_graph_partition_create</a>(&amp;partitions[0]));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__partition.html#gabdd1e8735d0f2f72165da4c2458121e0">dnnl_graph_partition_create</a>(&amp;partitions[1]));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a22"></a><a class="code" href="group__dnnl__graph__api__graph.html#gaf5c2c8684ac48acc413fb9cfbe699c60">dnnl_graph_graph_get_partitions</a>(graph, 2, partitions));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 6: Compile the partitions----------&quot;</span>);</div>
<div class="line">    dnnl_graph_compiled_partition_t *cpartitions[2];</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a23"></a><a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga6195715f5461f59b5f7e0b81c94d8ad6">dnnl_graph_compiled_partition_create</a>(</div>
<div class="line">            &amp;cpartitions[0], partitions[0]));</div>
<div class="line"> </div>
<div class="line">    int64_t conv0_src_dims[] = {BATCH, CONV0_IC, CONV0_IH, CONV0_IW};</div>
<div class="line">    int64_t conv0_weight_dims[] = {CONV0_OC, CONV0_IC, CONV0_KS, CONV0_KS};</div>
<div class="line">    int64_t conv0_bias_dims[] = {CONV0_OC};</div>
<div class="line">    int64_t conv0_dst_dims[] = {BATCH, CONV0_OC, CONV0_OH, CONV0_OW};</div>
<div class="line">    int64_t relu0_dst_dims[] = {conv0_dst_dims[0], conv0_dst_dims[1],</div>
<div class="line">            conv0_dst_dims[2], conv0_dst_dims[3]};</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> conv0_src_desc, conv0_weight_desc,</div>
<div class="line">            conv0_bias_desc, relu0_dst_desc;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a24"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad2c645ad00ecc288a830d19cae78dcec">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;conv0_src_desc,</div>
<div class="line">            CONV0_SRC_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4, conv0_src_dims,</div>
<div class="line">            <a name="a25"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad2c645ad00ecc288a830d19cae78dcec">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;conv0_weight_desc, CONV0_WEI_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4,</div>
<div class="line">            conv0_weight_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad2c645ad00ecc288a830d19cae78dcec">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;conv0_bias_desc,</div>
<div class="line">            CONV0_BIAS_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1, conv0_bias_dims,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad2c645ad00ecc288a830d19cae78dcec">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;relu0_dst_desc,</div>
<div class="line">            RELU0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4, relu0_dst_dims,</div>
<div class="line">            <a name="a26"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694afc5178ef75924c4f130c70cf7b223203">dnnl_graph_layout_type_any</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> *partition0_inputs[]</div>
<div class="line">            = {&amp;conv0_src_desc, &amp;conv0_weight_desc, &amp;conv0_bias_desc};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> *partition0_outputs[] = {&amp;relu0_dst_desc};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a27"></a><a class="code" href="group__dnnl__graph__api__partition.html#gac83bd7f73ce79908254aa98e967b0559">dnnl_graph_partition_compile</a>(partitions[0], cpartitions[0],</div>
<div class="line">            3, partition0_inputs, 1, partition0_outputs, engine));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a28"></a><a class="code" href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], RELU0_DST_ID, &amp;relu0_dst_desc));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga6195715f5461f59b5f7e0b81c94d8ad6">dnnl_graph_compiled_partition_create</a>(</div>
<div class="line">            &amp;cpartitions[1], partitions[1]));</div>
<div class="line"> </div>
<div class="line">    int64_t conv1_weight_dims[] = {CONV1_OC, CONV1_IC, CONV1_KS, CONV1_KS};</div>
<div class="line">    int64_t conv1_bias_dims[] = {CONV1_OC};</div>
<div class="line">    int64_t conv1_dst_dims[] = {BATCH, CONV1_OC, CONV1_OH, CONV1_OW};</div>
<div class="line">    int64_t relu1_dst_dims[] = {conv1_dst_dims[0], conv1_dst_dims[1],</div>
<div class="line">            conv1_dst_dims[2], conv1_dst_dims[3]};</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> conv1_src_desc, conv1_weight_desc,</div>
<div class="line">            conv1_bias_desc, relu1_dst_desc;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad2c645ad00ecc288a830d19cae78dcec">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;conv1_src_desc,</div>
<div class="line">            CONV1_SRC_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4, conv0_dst_dims,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694afc5178ef75924c4f130c70cf7b223203">dnnl_graph_layout_type_any</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad2c645ad00ecc288a830d19cae78dcec">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;conv1_weight_desc, CONV1_WEI_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4,</div>
<div class="line">            conv1_weight_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad2c645ad00ecc288a830d19cae78dcec">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;conv1_bias_desc,</div>
<div class="line">            CONV1_BIAS_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1, conv1_bias_dims,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gad2c645ad00ecc288a830d19cae78dcec">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;relu1_dst_desc,</div>
<div class="line">            RELU1_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4, relu1_dst_dims,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// FIXME(qun) what will happen when this logical tensor is strided instead of opaque?</span></div>
<div class="line">    <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> query_conv_src_lt;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], CONV1_SRC_ID, &amp;query_conv_src_lt));</div>
<div class="line">    conv1_src_desc.<a name="a29"></a><a class="code" href="structdnnl__graph__logical__tensor__t.html#a5e8dd6031f49c19cc2920e26c08f3be9">layout_type</a> = query_conv_src_lt.<a class="code" href="structdnnl__graph__logical__tensor__t.html#a5e8dd6031f49c19cc2920e26c08f3be9">layout_type</a>;</div>
<div class="line">    conv1_src_desc.<a name="a30"></a>layout.<a name="a31"></a><a class="code" href="structdnnl__graph__logical__tensor__t.html#af0fc868250dbefcd97d8e356c278bcdd">layout_id</a> = query_conv_src_lt.layout.<a class="code" href="structdnnl__graph__logical__tensor__t.html#af0fc868250dbefcd97d8e356c278bcdd">layout_id</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> *partition1_inputs[]</div>
<div class="line">            = {&amp;conv1_src_desc, &amp;conv1_weight_desc, &amp;conv1_bias_desc};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> *partition1_outputs[] = {&amp;relu1_dst_desc};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__partition.html#gac83bd7f73ce79908254aa98e967b0559">dnnl_graph_partition_compile</a>(partitions[1], cpartitions[1],</div>
<div class="line">            3, partition1_inputs, 1, partition1_outputs, engine));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 7: Alloc memory and execute--------&quot;</span>);</div>
<div class="line">    dnnl_graph_stream_t *stream = NULL;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a32"></a><a class="code" href="group__dnnl__graph__api__stream.html#ga9c7b4e3da3ff11defad596b68a389d6a">dnnl_graph_stream_create</a>(&amp;stream, engine));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> conv0_src_size, conv0_weight_size, conv0_bias_size, relu0_dst_size;</div>
<div class="line">    <span class="keywordtype">float</span> *conv0_src_data = NULL, *conv0_weight_data = NULL,</div>
<div class="line">          *conv0_bias_data = NULL, *relu0_dst_data = NULL;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> temp;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], CONV0_SRC_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a name="a33"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gada423dbef06b45e904dc91951094e252">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv0_src_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], CONV0_WEI_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gada423dbef06b45e904dc91951094e252">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv0_weight_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], CONV0_BIAS_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gada423dbef06b45e904dc91951094e252">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv0_bias_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], RELU0_DST_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gada423dbef06b45e904dc91951094e252">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;relu0_dst_size));</div>
<div class="line"> </div>
<div class="line">    conv0_src_data = (<span class="keywordtype">float</span> *)malloc(conv0_src_size);</div>
<div class="line">    conv0_weight_data = (<span class="keywordtype">float</span> *)malloc(conv0_weight_size);</div>
<div class="line">    conv0_bias_data = (<span class="keywordtype">float</span> *)malloc(conv0_bias_size);</div>
<div class="line">    relu0_dst_data = (<span class="keywordtype">float</span> *)malloc(relu0_dst_size);</div>
<div class="line">    <span class="keywordflow">if</span> (!conv0_src_data || !conv0_weight_data || !conv0_bias_data</div>
<div class="line">            || !relu0_dst_data) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: alloc memory failed\n&quot;</span>);</div>
<div class="line">        exit(1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv0_src_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv0_src_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv0_weight_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv0_weight_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv0_bias_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv0_bias_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    dnnl_graph_tensor_t *conv0_src, *conv0_weight, *conv0_bias, *relu0_dst;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a34"></a><a class="code" href="group__dnnl__graph__api__tensor.html#ga83ec5b0beb4cd0efa82903c6f72421a6">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv0_src, &amp;conv0_src_desc, engine, conv0_src_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga83ec5b0beb4cd0efa82903c6f72421a6">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv0_weight, &amp;conv0_weight_desc, engine, conv0_weight_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga83ec5b0beb4cd0efa82903c6f72421a6">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv0_bias, &amp;conv0_bias_desc, engine, conv0_bias_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga83ec5b0beb4cd0efa82903c6f72421a6">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;relu0_dst, &amp;relu0_dst_desc, engine, relu0_dst_data));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> dnnl_graph_tensor_t *cpartition0_inputs[]</div>
<div class="line">            = {conv0_src, conv0_weight, conv0_bias};</div>
<div class="line">    <span class="keyword">const</span> dnnl_graph_tensor_t *cpartition0_outputs[] = {relu0_dst};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a35"></a><a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga894a56f124c890241eeb060be09383cf">dnnl_graph_compiled_partition_execute</a>(cpartitions[0],</div>
<div class="line">            stream, 3, cpartition0_inputs, 1, cpartition0_outputs));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> conv1_weight_size, conv1_bias_size, relu1_dst_size;</div>
<div class="line">    <span class="keywordtype">float</span> *conv1_weight_data = NULL, *conv1_bias_data = NULL,</div>
<div class="line">          *relu1_dst_data = NULL;</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], CONV1_WEI_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gada423dbef06b45e904dc91951094e252">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv1_weight_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], CONV1_BIAS_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gada423dbef06b45e904dc91951094e252">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv1_bias_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], RELU1_DST_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gada423dbef06b45e904dc91951094e252">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;relu1_dst_size));</div>
<div class="line"> </div>
<div class="line">    conv1_weight_data = (<span class="keywordtype">float</span> *)malloc(conv1_weight_size);</div>
<div class="line">    conv1_bias_data = (<span class="keywordtype">float</span> *)malloc(conv1_bias_size);</div>
<div class="line">    relu1_dst_data = (<span class="keywordtype">float</span> *)malloc(relu1_dst_size);</div>
<div class="line">    <span class="keywordflow">if</span> (!conv1_weight_data || !conv1_bias_data || !relu1_dst_data) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: alloc memory failed\n&quot;</span>);</div>
<div class="line">        exit(1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv1_weight_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv1_weight_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv1_bias_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        <span class="comment">// hard code the excepted results</span></div>
<div class="line">        conv1_bias_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    dnnl_graph_tensor_t *conv1_src, *conv1_weight, *conv1_bias, *relu1_dst;</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__tensor.html#ga83ec5b0beb4cd0efa82903c6f72421a6">dnnl_graph_tensor_create</a>(&amp;conv1_src, &amp;conv1_src_desc, engine,</div>
<div class="line">                    relu0_dst_data)); <span class="comment">// use compiled partition[0] output buffer</span></div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga83ec5b0beb4cd0efa82903c6f72421a6">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv1_weight, &amp;conv1_weight_desc, engine, conv1_weight_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga83ec5b0beb4cd0efa82903c6f72421a6">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv1_bias, &amp;conv1_bias_desc, engine, conv1_bias_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga83ec5b0beb4cd0efa82903c6f72421a6">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;relu1_dst, &amp;relu1_dst_desc, engine, relu1_dst_data));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> dnnl_graph_tensor_t *cpartition1_inputs[]</div>
<div class="line">            = {relu0_dst, conv1_weight, conv1_bias};</div>
<div class="line">    <span class="keyword">const</span> dnnl_graph_tensor_t *cpartition1_outputs[] = {relu1_dst};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga894a56f124c890241eeb060be09383cf">dnnl_graph_compiled_partition_execute</a>(cpartitions[1],</div>
<div class="line">            stream, 3, cpartition1_inputs, 1, cpartition1_outputs));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a36"></a><a class="code" href="group__dnnl__graph__api__stream.html#gae81389e653c36d37a9c3b8ea6fd6d7c8">dnnl_graph_stream_destroy</a>(stream));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 8: Check correctness---------------&quot;</span>);</div>
<div class="line">    <span class="keywordtype">float</span> excepted_result</div>
<div class="line">            = (1 * 11 * 11 * 3 + <span class="comment">/* conv0 bias */</span> 1.0f) * (1 * 1 * 96)</div>
<div class="line">            + <span class="comment">/* conv1 bias */</span> 1.0f;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; relu1_dst_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (fabsf(excepted_result - relu1_dst_data[i]) &gt; 1e-6f) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Error: output result is not equal to excepted &quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;results\n&quot;</span>);</div>
<div class="line">            exit(1);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    free(conv0_src_data);</div>
<div class="line">    free(conv0_weight_data);</div>
<div class="line">    free(conv0_bias_data);</div>
<div class="line">    free(relu0_dst_data);</div>
<div class="line">    free(conv1_weight_data);</div>
<div class="line">    free(conv1_bias_data);</div>
<div class="line">    free(relu1_dst_data);</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a37"></a><a class="code" href="group__dnnl__graph__api__tensor.html#ga60be2b5676853581a130eea7f43bc506">dnnl_graph_tensor_destroy</a>(conv0_src));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga60be2b5676853581a130eea7f43bc506">dnnl_graph_tensor_destroy</a>(conv0_weight));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga60be2b5676853581a130eea7f43bc506">dnnl_graph_tensor_destroy</a>(conv0_bias));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga60be2b5676853581a130eea7f43bc506">dnnl_graph_tensor_destroy</a>(relu0_dst));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga60be2b5676853581a130eea7f43bc506">dnnl_graph_tensor_destroy</a>(conv1_src));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga60be2b5676853581a130eea7f43bc506">dnnl_graph_tensor_destroy</a>(conv1_weight));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga60be2b5676853581a130eea7f43bc506">dnnl_graph_tensor_destroy</a>(conv1_bias));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga60be2b5676853581a130eea7f43bc506">dnnl_graph_tensor_destroy</a>(relu1_dst));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a38"></a><a class="code" href="group__dnnl__graph__api__partition.html#gabd2c5c87653fd91cc8299d4034d218fa">dnnl_graph_partition_destroy</a>(partitions[0]));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__partition.html#gabd2c5c87653fd91cc8299d4034d218fa">dnnl_graph_partition_destroy</a>(partitions[1]));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a39"></a><a class="code" href="group__dnnl__graph__api__compiled__partition.html#gadb5bacd35a4fc599fd53b10a3d1e53a6">dnnl_graph_compiled_partition_destroy</a>(cpartitions[0]));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#gadb5bacd35a4fc599fd53b10a3d1e53a6">dnnl_graph_compiled_partition_destroy</a>(cpartitions[1]));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a40"></a><a class="code" href="group__dnnl__graph__api__op.html#gac0387fba6a462049a3edf9a944b8ceba">dnnl_graph_op_destroy</a>(conv0));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac0387fba6a462049a3edf9a944b8ceba">dnnl_graph_op_destroy</a>(relu0));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac0387fba6a462049a3edf9a944b8ceba">dnnl_graph_op_destroy</a>(conv1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac0387fba6a462049a3edf9a944b8ceba">dnnl_graph_op_destroy</a>(relu1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac0387fba6a462049a3edf9a944b8ceba">dnnl_graph_op_destroy</a>(bias_add0));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gac0387fba6a462049a3edf9a944b8ceba">dnnl_graph_op_destroy</a>(bias_add1));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a41"></a><a class="code" href="group__dnnl__graph__api__graph.html#ga81b728dd786b54ad00ae27c653fda997">dnnl_graph_graph_destroy</a>(graph));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a42"></a><a class="code" href="group__dnnl__graph__api__engine.html#ga902b3342c537e89283590657ab2b532d">dnnl_graph_engine_destroy</a>(engine));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a43"></a><a class="code" href="group__dnnl__graph__api__allocator.html#gaf8f63df0c97379b2748819f19c5c2449">dnnl_graph_allocator_destroy</a>(allocator));</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Example pass\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="adnnl__graph_8h_html"><div class="ttname"><a href="dnnl__graph_8h.html">dnnl_graph.h</a></div><div class="ttdoc">C API.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__allocator_html_ga72814446b3a0791919fc922ab5b84325"><div class="ttname"><a href="group__dnnl__graph__api__allocator.html#ga72814446b3a0791919fc922ab5b84325">dnnl_graph_allocator_create</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_allocator_create(dnnl_graph_allocator_t **created_allocator, dnnl_graph_cpu_allocate_f cpu_malloc, dnnl_graph_cpu_deallocate_f cpu_free)</div><div class="ttdoc">Initializes an allocator with the given allocation and deallocation call-back function pointers (CPU)</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__allocator_html_gaf8f63df0c97379b2748819f19c5c2449"><div class="ttname"><a href="group__dnnl__graph__api__allocator.html#gaf8f63df0c97379b2748819f19c5c2449">dnnl_graph_allocator_destroy</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_allocator_destroy(dnnl_graph_allocator_t *allocator)</div><div class="ttdoc">Destroys the created allocator.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__compiled__partition_html_ga6195715f5461f59b5f7e0b81c94d8ad6"><div class="ttname"><a href="group__dnnl__graph__api__compiled__partition.html#ga6195715f5461f59b5f7e0b81c94d8ad6">dnnl_graph_compiled_partition_create</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_compiled_partition_create(dnnl_graph_compiled_partition_t **compiled_partition, dnnl_graph_partition_t *partition)</div><div class="ttdoc">Creates a new compiled partition.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__compiled__partition_html_ga894a56f124c890241eeb060be09383cf"><div class="ttname"><a href="group__dnnl__graph__api__compiled__partition.html#ga894a56f124c890241eeb060be09383cf">dnnl_graph_compiled_partition_execute</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_compiled_partition_execute(const dnnl_graph_compiled_partition_t *compiled_partition, const dnnl_graph_stream_t *stream, const uint64_t num_inputs, const dnnl_graph_tensor_t **inputs, const uint64_t num_outputs, const dnnl_graph_tensor_t **outputs)</div><div class="ttdoc">Execute a compiled partition.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__compiled__partition_html_gabb66f2bd97e30ee1578449f4b2f90fe9"><div class="ttname"><a href="group__dnnl__graph__api__compiled__partition.html#gabb66f2bd97e30ee1578449f4b2f90fe9">dnnl_graph_compiled_partition_query_logical_tensor</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_compiled_partition_query_logical_tensor(const dnnl_graph_compiled_partition_t *compiled_partition, size_t tid, dnnl_graph_logical_tensor_t *lt)</div><div class="ttdoc">Returns the logical tensor according to tensor id.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__compiled__partition_html_gadb5bacd35a4fc599fd53b10a3d1e53a6"><div class="ttname"><a href="group__dnnl__graph__api__compiled__partition.html#gadb5bacd35a4fc599fd53b10a3d1e53a6">dnnl_graph_compiled_partition_destroy</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_compiled_partition_destroy(dnnl_graph_compiled_partition_t *compiled_partition)</div><div class="ttdoc">Destroy the target compiled partition.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_ga6ac1ba87052e33099253f1d21ddd0091"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#ga6ac1ba87052e33099253f1d21ddd0091">dnnl_graph_engine_kind_t</a></div><div class="ttdeci">dnnl_graph_engine_kind_t</div><div class="ttdoc">Kind for engine.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:160</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_ga902b3342c537e89283590657ab2b532d"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#ga902b3342c537e89283590657ab2b532d">dnnl_graph_engine_destroy</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_engine_destroy(dnnl_graph_engine_t *engine)</div><div class="ttdoc">Destroy the target engine.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_gae62032eb1c9997864d209de1023e2edd"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#gae62032eb1c9997864d209de1023e2edd">dnnl_graph_engine_set_allocator</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_engine_set_allocator(dnnl_graph_engine_t *engine, dnnl_graph_allocator_t *allocator)</div><div class="ttdoc">Set an allocator to the target engine.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_gaffbc76b0e5aaa1683475940224c7da2b"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#gaffbc76b0e5aaa1683475940224c7da2b">dnnl_graph_engine_create</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_engine_create(dnnl_graph_engine_t **created_engine, dnnl_graph_engine_kind_t engine_kind, int32_t device_id)</div><div class="ttdoc">Creates an engine with specified engine kind and device id.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_gga6ac1ba87052e33099253f1d21ddd0091a0e4015e41880cfeee945c30cbf346da2"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#gga6ac1ba87052e33099253f1d21ddd0091a0e4015e41880cfeee945c30cbf346da2">dnnl_graph_gpu</a></div><div class="ttdeci">@ dnnl_graph_gpu</div><div class="ttdoc">GPU engine.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:166</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_ga27e4c096e75702ef2a885c2cecd64d12"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#ga27e4c096e75702ef2a885c2cecd64d12">dnnl_graph_graph_filter</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_graph_filter(dnnl_graph_graph_t *graph, dnnl_graph_partition_policy_t policy)</div><div class="ttdoc">Do graph filtering and partitioning.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_ga46e3946d6079590f03205f660be1b5fe"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#ga46e3946d6079590f03205f660be1b5fe">dnnl_graph_add_op</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_add_op(dnnl_graph_graph_t *graph, dnnl_graph_op_t *op)</div><div class="ttdoc">Add a new op to a graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_ga81b728dd786b54ad00ae27c653fda997"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#ga81b728dd786b54ad00ae27c653fda997">dnnl_graph_graph_destroy</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_graph_destroy(dnnl_graph_graph_t *graph)</div><div class="ttdoc">Destroy the target graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_gab0799273b35e51deb13ebaf510124a8b"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#gab0799273b35e51deb13ebaf510124a8b">dnnl_graph_graph_get_partition_num</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_graph_get_partition_num(const dnnl_graph_graph_t *graph, uint64_t *num)</div><div class="ttdoc">Gets the number of partitions of the graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_gadfe53f5827f6a1b22c6a3d379b229af9"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#gadfe53f5827f6a1b22c6a3d379b229af9">dnnl_graph_graph_create</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_graph_create(dnnl_graph_graph_t **created_graph, dnnl_graph_engine_kind_t device_type)</div><div class="ttdoc">Creates a new empty graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_gaf5c2c8684ac48acc413fb9cfbe699c60"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#gaf5c2c8684ac48acc413fb9cfbe699c60">dnnl_graph_graph_get_partitions</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_graph_get_partitions(dnnl_graph_graph_t *graph, uint64_t num, dnnl_graph_partition_t **partition)</div><div class="ttdoc">Gets the filtered partitions of the graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gad2c645ad00ecc288a830d19cae78dcec"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gad2c645ad00ecc288a830d19cae78dcec">dnnl_graph_logical_tensor_init_with_dims</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_logical_tensor_init_with_dims(dnnl_graph_logical_tensor_t *created_logical_tensor, size_t tid, dnnl_graph_data_type_t dtype, int32_t ndims, const dnnl_graph_dims_t dims, dnnl_graph_layout_type_t ltype, dnnl_graph_tensor_property_t ptype)</div><div class="ttdoc">Initializes a logical tensor with basic information, dims, and property.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gad466968473718879bb17d189aad851e4"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gad466968473718879bb17d189aad851e4">dnnl_graph_logical_tensor_init</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_logical_tensor_init(dnnl_graph_logical_tensor_t *created_logical_tensor, size_t tid, dnnl_graph_data_type_t dtype, int32_t ndims, dnnl_graph_layout_type_t ltype, dnnl_graph_tensor_property_t ptype)</div><div class="ttdoc">Initializes a logical tensor with id, data type, ndims, layout type, and property.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gada423dbef06b45e904dc91951094e252"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gada423dbef06b45e904dc91951094e252">dnnl_graph_logical_tensor_get_mem_size</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_logical_tensor_get_mem_size(const dnnl_graph_logical_tensor_t *logical_tensor, size_t *size)</div><div class="ttdoc">Returns the memory size described by the logical tensor.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a></div><div class="ttdeci">@ dnnl_graph_layout_type_undef</div><div class="ttdoc">undefined layout type</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:240</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a></div><div class="ttdeci">@ dnnl_graph_layout_type_strided</div><div class="ttdoc">strided means that the layout is determined by the strides field.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:245</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gga5b552d8a81835eb955253410bf012694afc5178ef75924c4f130c70cf7b223203"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694afc5178ef75924c4f130c70cf7b223203">dnnl_graph_layout_type_any</a></div><div class="ttdeci">@ dnnl_graph_layout_type_any</div><div class="ttdoc">any means that oneDNN graph implementation needs to decide the layout for the compiled partition.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:243</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a></div><div class="ttdeci">@ dnnl_graph_f32</div><div class="ttdoc">32-bit/single-precision floating point.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:83</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a></div><div class="ttdeci">@ dnnl_graph_tensor_property_undef</div><div class="ttdoc">undefined tensor property</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:254</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_ga862fb0704b7712f99ec60d7a9c4a70ac"><div class="ttname"><a href="group__dnnl__graph__api__op.html#ga862fb0704b7712f99ec60d7a9c4a70ac">dnnl_graph_op_add_attr</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_op_add_attr(dnnl_graph_op_t *op, const char *name, dnnl_graph_attribute_kind_t kind, const void *attr, int64_t attr_no)</div><div class="ttdoc">Sets the attribute according to the name and kind.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gaa04492222b1da2e74ed6c8e0e13d7ea3"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gaa04492222b1da2e74ed6c8e0e13d7ea3">dnnl_graph_op_create</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_op_create(dnnl_graph_op_t **created_op, uint64_t id, dnnl_graph_op_kind_t kind, const char *const debug_string)</div><div class="ttdoc">Initializes an op with unique id, kind and debug string.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gac0387fba6a462049a3edf9a944b8ceba"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gac0387fba6a462049a3edf9a944b8ceba">dnnl_graph_op_destroy</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_op_destroy(dnnl_graph_op_t *op)</div><div class="ttdoc">Destroys the created op.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gac4e6257c11f83655f5a75dd538f16938"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gac4e6257c11f83655f5a75dd538f16938">dnnl_graph_op_add_input</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_op_add_input(dnnl_graph_op_t *op, const dnnl_graph_logical_tensor_t *input)</div><div class="ttdoc">Adds input logical tensor to the op.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gaf57b836c94bc9974da2da67a0a68baf2"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gaf57b836c94bc9974da2da67a0a68baf2">dnnl_graph_op_add_output</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_op_add_output(dnnl_graph_op_t *op, const dnnl_graph_logical_tensor_t *output)</div><div class="ttdoc">Adds output logical tensor to the op.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa0b471cdaa3ee55db0c667f26e0973dbc">dnnl_graph_attribute_kind_is</a></div><div class="ttdeci">@ dnnl_graph_attribute_kind_is</div><div class="ttdoc">atributes with list of int64_t</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:192</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga56fcbd336ee8259ef768a78ac21387efa5c446fd6f0882f92546239ffddad2451"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa5c446fd6f0882f92546239ffddad2451">dnnl_graph_attribute_kind_i</a></div><div class="ttdeci">@ dnnl_graph_attribute_kind_i</div><div class="ttdoc">attributes with int64_t type</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:190</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga56fcbd336ee8259ef768a78ac21387efa5f2ffc9a38e9d53cfe93fe94204489a4"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga56fcbd336ee8259ef768a78ac21387efa5f2ffc9a38e9d53cfe93fe94204489a4">dnnl_graph_attribute_kind_s</a></div><div class="ttdeci">@ dnnl_graph_attribute_kind_s</div><div class="ttdoc">attributes with string type</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:194</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__partition_html_gabd2c5c87653fd91cc8299d4034d218fa"><div class="ttname"><a href="group__dnnl__graph__api__partition.html#gabd2c5c87653fd91cc8299d4034d218fa">dnnl_graph_partition_destroy</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_partition_destroy(dnnl_graph_partition_t *partition)</div><div class="ttdoc">Destroy the target partition.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__partition_html_gabdd1e8735d0f2f72165da4c2458121e0"><div class="ttname"><a href="group__dnnl__graph__api__partition.html#gabdd1e8735d0f2f72165da4c2458121e0">dnnl_graph_partition_create</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_partition_create(dnnl_graph_partition_t **partition)</div><div class="ttdoc">Creates a new empty partition.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__partition_html_gac83bd7f73ce79908254aa98e967b0559"><div class="ttname"><a href="group__dnnl__graph__api__partition.html#gac83bd7f73ce79908254aa98e967b0559">dnnl_graph_partition_compile</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_partition_compile(dnnl_graph_partition_t *partition, dnnl_graph_compiled_partition_t *compiled_partition, uint64_t in_num, const dnnl_graph_logical_tensor_t **inputs, uint64_t out_num, const dnnl_graph_logical_tensor_t **outputs, const dnnl_graph_engine_t *engine)</div><div class="ttdoc">Compile the partition with given input and output logical tensors.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__partition_html_gga7e24b277b64600ef3a83dac2e8dfa83ba1489f3f9bb1262b58fa0bf0524d883a4"><div class="ttname"><a href="group__dnnl__graph__api__partition.html#gga7e24b277b64600ef3a83dac2e8dfa83ba1489f3f9bb1262b58fa0bf0524d883a4">dnnl_graph_partition_policy_fusion</a></div><div class="ttdeci">@ dnnl_graph_partition_policy_fusion</div><div class="ttdoc">Have fusion.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:102</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__stream_html_ga9c7b4e3da3ff11defad596b68a389d6a"><div class="ttname"><a href="group__dnnl__graph__api__stream.html#ga9c7b4e3da3ff11defad596b68a389d6a">dnnl_graph_stream_create</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_stream_create(dnnl_graph_stream_t **created_stream, const dnnl_graph_engine_t *engine)</div><div class="ttdoc">Creates a stream for the specified engine.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__stream_html_gae81389e653c36d37a9c3b8ea6fd6d7c8"><div class="ttname"><a href="group__dnnl__graph__api__stream.html#gae81389e653c36d37a9c3b8ea6fd6d7c8">dnnl_graph_stream_destroy</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_stream_destroy(dnnl_graph_stream_t *stream)</div><div class="ttdoc">Destroy the target stream.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__tensor_html_ga60be2b5676853581a130eea7f43bc506"><div class="ttname"><a href="group__dnnl__graph__api__tensor.html#ga60be2b5676853581a130eea7f43bc506">dnnl_graph_tensor_destroy</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_tensor_destroy(dnnl_graph_tensor_t *tensor)</div><div class="ttdoc">Destroys the created tensor.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__tensor_html_ga83ec5b0beb4cd0efa82903c6f72421a6"><div class="ttname"><a href="group__dnnl__graph__api__tensor.html#ga83ec5b0beb4cd0efa82903c6f72421a6">dnnl_graph_tensor_create</a></div><div class="ttdeci">dnnl_graph_result_t DNNL_GRAPH_API dnnl_graph_tensor_create(dnnl_graph_tensor_t **tensor, const dnnl_graph_logical_tensor_t *logical_tensor, const dnnl_graph_engine_t *engine, void *handle)</div><div class="ttdoc">Initializes a tensor with logical tensor, engine, and data handle.</div></div>
<div class="ttc" id="astructdnnl__graph__logical__tensor__t_html"><div class="ttname"><a href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a></div><div class="ttdoc">logical tensor definition</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:262</div></div>
<div class="ttc" id="astructdnnl__graph__logical__tensor__t_html_a5e8dd6031f49c19cc2920e26c08f3be9"><div class="ttname"><a href="structdnnl__graph__logical__tensor__t.html#a5e8dd6031f49c19cc2920e26c08f3be9">dnnl_graph_logical_tensor_t::layout_type</a></div><div class="ttdeci">dnnl_graph_layout_type_t layout_type</div><div class="ttdoc">Layout type of the tensor: any, strided, or opaque.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:279</div></div>
<div class="ttc" id="astructdnnl__graph__logical__tensor__t_html_af0fc868250dbefcd97d8e356c278bcdd"><div class="ttname"><a href="structdnnl__graph__logical__tensor__t.html#af0fc868250dbefcd97d8e356c278bcdd">dnnl_graph_logical_tensor_t::layout_id</a></div><div class="ttdeci">size_t layout_id</div><div class="ttdoc">Valid when layout_type is dnnl_graph_opaque.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:287</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<div class="footer">
    <script>
        $('#top').prependTo($('#side-nav'));
    </script>
    <div class="footer-wrapper">
        <hr>
        <ul class="footer-links">
            <li><a href="legal_information.html">Legal information</a></li>
        </ul>
    </div>
</div>