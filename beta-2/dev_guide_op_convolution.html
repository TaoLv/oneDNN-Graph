<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>oneDNN Graph: Convolution</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script src="assets/mathjax/MathJax.js?config=TeX-AMS_CHTML,dnnl"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="assets/customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="assets/dnn.js"></script>
</head>
<body>
<div class="mobile-nav"><i id="nav-btn"></i><a href="index.html">oneAPI Deep Neural Network Library Graph API (oneDNN Graph)</a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname">
     <a href="index.html">
      <div id="full-name">oneAPI Deep Neural Network Library Graph API (oneDNN Graph)</div>
    </a>
   </div>
   <div id="projectbrief">Performance Library for DNN Graph Optimization</div>
   <div id="projectnumber">0.7.2</div>
  <div>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dev_guide_op_convolution.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Convolution </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_operations_Convolution"></a> <b>Versioned name</b>: <em>Convolution-1</em></p>
<p><b>Category</b>: Convolution</p>
<p><b>Short description</b>: <a href="http://caffe.berkeleyvision.org/tutorial/layers/convolution.html">Reference</a></p>
<p><b>Detailed description</b>: <a href="ttp://cs231n.github.io/convolutional-networks/#conv">Reference</a></p>
<p>In this description, \(r\) denotes the spatial rank. We describe the convolution for each sample in a batch of \(N\) inputs; the results are combined into an output batch of size \(N\).</p>
<p>The convolution is implemented as if each sample input first has \(p_b\) zeros inserted before and \(p_e\) zeros inserted for the channels on the spatial axes, giving a padded input size of \(p_b+p_e+X_I\).</p>
<p>The kernel is stretched by a factor of \(d\) on each of its spatial dimensions. The last index of the stretched kernel is then \(d(X_K-1)\) so the shape is \(d(X_K-1)+1\).</p>
<p>The padded input and the dilated kernel are then ungrouped into \(g\) equal-sized\ input and kernel segments; padded input segment \(i\) and dilated kernel segment \(i\) are convolved. The convolution is only performed where there is complete spatial overlap between the shifted kernel and the padded input, so there will be \(p_b+p_e+X_I-d(X_K-1)\) outputs. The output segments are then regrouped along the output channel axis. Finally, all but the results on a multiple of \(d\) spatial axis are removed, so the output will have size:</p>
<p>\( \left\lfloor \frac{p_b+p_e+X_I-d(X_K-1)-1}{s} \right\rfloor +1\)</p>
<h1><a class="anchor" id="autotoc_md58"></a>
Attributes</h1>
<ul>
<li><em>strides</em><ul>
<li><b>Description</b>: <em>strides</em> is how much the convolution output is down-sampled to produce the output.</li>
<li><b>Range of values</b>: positive s64 values.</li>
<li><b>Type</b>: s64[]</li>
<li><b>Required</b>: <em>yes</em></li>
</ul>
</li>
<li><em>pads_begin</em><ul>
<li><b>Description</b>: <em>pads_begin</em> is a number of zeros to add to the beginning of each spatial axis.</li>
<li><b>Range of values</b>: non-negative s64 values.</li>
<li><b>Type</b>: s64[]</li>
<li><b>Required</b>: <em>yes</em></li>
<li><b>Note</b>: the attribute is ignored when <em>auto_pad</em> attribute is specified.</li>
</ul>
</li>
<li><em>pads_end</em><ul>
<li><b>Description</b>: <em>pads_end</em> is a number of zeros to add to the end of each spatial axis.</li>
<li><b>Range of values</b>: non-negative s64 values.</li>
<li><b>Type</b>: s64[]</li>
<li><b>Required</b>: <em>yes</em></li>
<li><b>Note</b>: the attribute is ignored when <em>auto_pad</em> attribute is specified.</li>
</ul>
</li>
<li><em>dilations</em><ul>
<li><b>Description</b>: <em>dilations</em> denotes the amount to stretch the kernel before convolving.</li>
<li><b>Range of values</b>: positive s64 values.</li>
<li><b>Type</b>: s64[]</li>
<li><b>Required</b>: <em>yes</em></li>
</ul>
</li>
<li><em>auto_pad</em><ul>
<li><b>Description</b>: <em>auto_pad</em> how the padding is calculated. Possible values:<ul>
<li><em>none (not specified)</em>: use explicit padding values.</li>
<li><em>same_upper (same_lower)</em> the input is padded to match the output size. In case of odd padding value an extra padding is added at the end (at the beginning).</li>
<li><em>valid</em> - No padding ( \(p_b=p_e=0\)).</li>
</ul>
</li>
<li><b>Type</b>: string</li>
<li><b>Default value</b>: <em>none</em></li>
<li><b>Required</b>: <em>no</em></li>
<li><b>Note</b>: <em>pads_begin</em> and <em>pads_end</em> attributes are ignored when <em>auto_pad</em> is specified. With <em>same_upper</em> and <em>same_lower</em> the padding is chosen to make the pre-stride output spatial shape the same as the input shape. When possible, \(p_b=p_e\). If the total padding needed is odd, <em>same_upper</em> makes \(p_e=p_b+1\), <em>same_lower</em> makes \(p_b=p_e+1\). In either case, \( p_b+p_e=d(X_I-1)\)</li>
</ul>
</li>
<li><em>groups</em><ul>
<li><b>Description</b>: <em>groups</em> denotes the number of groups input channels and output channels are divided into. In_channels and out_channels must both be divisible by groups</li>
<li><b>Range of values</b>: a positive s64 value.</li>
<li><b>Type</b>: s64</li>
<li><b>Default value</b>: 1</li>
<li><b>Required</b>: <em>no</em></li>
</ul>
</li>
<li><em>data_format</em><ul>
<li><b>Description</b>: <em>data_format</em> denotes the format of the input and output data.</li>
<li><b>Range of values</b>: <em>NXC</em> or <em>NCX</em> (X means HW for 2D convolution, DHW for 3D convolution)</li>
<li><b>Type</b>: string</li>
<li><b>Default value</b>: <em>NXC</em></li>
<li><b>Required</b>: <em>no</em></li>
</ul>
</li>
<li><em>filter_format</em><ul>
<li><b>Description</b>: <em>filter_format</em> denotes the format of the filter.</li>
<li><b>Range of values</b>: <em>XIO</em> or <em>OIX</em> (X means HW for 2D convolution, DHW for 3D convolution)</li>
<li><b>Type</b>: string</li>
<li><b>Default value</b>: <em>XIO</em></li>
<li><b>Required</b>: <em>no</em></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md59"></a>
Inputs</h1>
<ul>
<li><b>1</b>: <code>input</code> - the input tensor. The format is specified by <em>data_format</em> attribute. <b>Required.</b><ul>
<li><b>Type</b>: T</li>
</ul>
</li>
<li><b>2</b>: <code>filter</code> - convolution filter tensor. The format is specified by <em>filter_format</em>. The shape of filter is \((out\_channels, in\_channels / groups, spatial\_shape)\) for OIX format or \((spatial\_shape, in\_channels / groups, out\_channels)\) for XIO format. \(in\_channels\) and \(out\_channels\) must both be divisible by <em>groups</em> attribute. <b>Required.</b><ul>
<li><b>Type</b>: T</li>
</ul>
</li>
<li><b>3</b>: <code>bias</code> - a 1-D tensor adds to channel dimension of input. Broadcasting is supported. <b>Optional.</b><ul>
<li><b>Type</b>: T</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md60"></a>
Outputs</h1>
<ul>
<li><b>1</b>: <code>output</code> - the output tensor. The format is specified by <em>data_format</em> attribute.<ul>
<li><b>Type</b>: T</li>
</ul>
</li>
</ul>
<p><b>Types</b>:</p>
<ul>
<li><b>T</b>: f32, f16, bf16.</li>
<li><b>Note</b>: Inputs and outputs have the same data type denoted by <em>T</em>. For example, if input is f32 tensor, then all other tensors have f32 data type. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="footer">
    <script>
        $('#top').prependTo($('#side-nav'));
    </script>
    <div class="footer-wrapper">
        <hr>
        <ul class="footer-links">
            <li><a href="legal_information.html">Legal information</a></li>
        </ul>
    </div>
</div>