<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>oneDNN Graph: cpu_conv_bias_bn_add_relu.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script src="assets/mathjax/MathJax.js?config=TeX-AMS_CHTML,dnnl"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="assets/customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="assets/dnn.js"></script>
</head>
<body>
<div class="mobile-nav"><i id="nav-btn"></i><a href="index.html">oneAPI Deep Neural Network Library Graph API (oneDNN Graph)</a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname">
     <a href="index.html">
      <div id="full-name">oneAPI Deep Neural Network Library Graph API (oneDNN Graph)</div>
    </a>
   </div>
   <div id="projectbrief">Performance Library for DNN Graph Optimization</div>
   <div id="projectnumber">0.7.2</div>
  <div>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('cpu_conv_bias_bn_add_relu_8c-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">cpu_conv_bias_bn_add_relu.c</div>  </div>
</div><!--header-->
<div class="contents">
<blockquote class="doxtable">
<p>Example code: <a class="el" href="cpu_conv_bias_bn_add_relu_8c-example.html">cpu_conv_bias_bn_add_relu.c</a> </p>
</blockquote>
<blockquote class="doxtable">
<p>Annotated version: <a class="el" href="cpu_conv_bias_bn_add_relu_c.html">CPU example for conv+bias+bn+add_relu pattern</a> </p>
</blockquote>
<div class="fragment"><div class="line"><span class="comment">/*******************************************************************************</span></div>
<div class="line"><span class="comment">* Copyright 2020-2022 Intel Corporation</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><span class="comment">* you may not use this file except in compliance with the License.</span></div>
<div class="line"><span class="comment">* You may obtain a copy of the License at</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">*     http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><span class="comment">*</span></div>
<div class="line"><span class="comment">* Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><span class="comment">* distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><span class="comment">* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><span class="comment">* See the License for the specific language governing permissions and</span></div>
<div class="line"><span class="comment">* limitations under the License.</span></div>
<div class="line"><span class="comment">*******************************************************************************/</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;common/allocator.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;common/utils.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="dnnl__graph_8h.html">oneapi/dnnl/dnnl_graph.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// The original graph is:</span></div>
<div class="line"><span class="comment">// digraph G {</span></div>
<div class="line"><span class="comment">// Convolution_100002 -&gt; BiasAdd_100003;</span></div>
<div class="line"><span class="comment">// BiasAdd_100003 -&gt; BatchNormInference_100004;</span></div>
<div class="line"><span class="comment">// Convolution_100005 -&gt; BiasAdd_100006;</span></div>
<div class="line"><span class="comment">// BiasAdd_100006 -&gt; BatchNormInference_100007;</span></div>
<div class="line"><span class="comment">// BatchNormInference_100004 -&gt; Add_100008;</span></div>
<div class="line"><span class="comment">// BatchNormInference_100007 -&gt; Add_100008;</span></div>
<div class="line"><span class="comment">// Add_100008 -&gt; ReLU_100009;</span></div>
<div class="line"><span class="comment">// }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The optimoptimized graph is:</span></div>
<div class="line"><span class="comment">// digraph G {</span></div>
<div class="line"><span class="comment">// Conv_bias_bn_100120 -&gt; Conv_bias_bn_add_relu_100038;</span></div>
<div class="line"><span class="comment">// }</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">// Pre-define unique id for dnnl_graph_op,</span></div>
<div class="line"><span class="comment">// used to represent op in computation graph</span></div>
<div class="line"><span class="preprocessor">#define CONV0_ID 0</span></div>
<div class="line"><span class="preprocessor">#define CONV1_ID 1</span></div>
<div class="line"><span class="preprocessor">#define BIAS_ADD0_ID 2</span></div>
<div class="line"><span class="preprocessor">#define BIAS_ADD1_ID 3</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM0_ID 4</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM1_ID 5</span></div>
<div class="line"><span class="preprocessor">#define ADD0_ID 6</span></div>
<div class="line"><span class="preprocessor">#define RELU0_ID 7</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Predefine unique id for dnnl_graph_logical_tensor,</span></div>
<div class="line"><span class="comment">// used to represent edge in computation graph</span></div>
<div class="line"><span class="preprocessor">#define CONV0_SRC_ID 0</span></div>
<div class="line"><span class="preprocessor">#define CONV0_WEI_ID 1</span></div>
<div class="line"><span class="preprocessor">#define CONV0_DST_ID 2</span></div>
<div class="line"><span class="preprocessor">#define CONV0_BIAS_ID 3</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONV1_SRC_ID 4</span></div>
<div class="line"><span class="preprocessor">#define CONV1_WEI_ID 5</span></div>
<div class="line"><span class="preprocessor">#define CONV1_DST_ID 6</span></div>
<div class="line"><span class="preprocessor">#define CONV1_BIAS_ID 7</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define BIAS_ADD0_DST_ID 8</span></div>
<div class="line"><span class="preprocessor">#define BIAS_ADD1_DST_ID 9</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define BATCH_NORM0_SCALE_ID 10</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM0_SHIFT_ID 11</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM0_MEAN_ID 12</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM0_VARIANCE_ID 13</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM0_DST_ID 14</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define BATCH_NORM1_SCALE_ID 15</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM1_SHIFT_ID 16</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM1_MEAN_ID 17</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM1_VARIANCE_ID 18</span></div>
<div class="line"><span class="preprocessor">#define BATCH_NORM1_DST_ID 19</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define ADD0_SRC0_ID 14</span></div>
<div class="line"><span class="preprocessor">#define ADD0_SRC1_ID 19</span></div>
<div class="line"><span class="preprocessor">#define ADD0_DST_ID 20</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define RELU0_SRC_ID 20</span></div>
<div class="line"><span class="preprocessor">#define RELU0_DST_ID 21</span></div>
<div class="line"><span class="comment">// pre-defined net parameters</span></div>
<div class="line"><span class="preprocessor">#define BATCH 8</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONV0_IC 3</span></div>
<div class="line"><span class="preprocessor">#define CONV0_OC 96</span></div>
<div class="line"><span class="preprocessor">#define CONV0_IH 227</span></div>
<div class="line"><span class="preprocessor">#define CONV0_IW 227</span></div>
<div class="line"><span class="preprocessor">#define CONV0_OH 55</span></div>
<div class="line"><span class="preprocessor">#define CONV0_OW 55</span></div>
<div class="line"><span class="preprocessor">#define CONV0_KS 11</span></div>
<div class="line"><span class="preprocessor">#define CONV0_STRIDE 4</span></div>
<div class="line"><span class="preprocessor">#define CONV0_PADDING 0</span></div>
<div class="line"><span class="preprocessor">#define CONV0_DILATION 1</span></div>
<div class="line"><span class="preprocessor">#define CONV0_GROUPS 1</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONV1_IC 3</span></div>
<div class="line"><span class="preprocessor">#define CONV1_OC 96</span></div>
<div class="line"><span class="preprocessor">#define CONV1_IH 227</span></div>
<div class="line"><span class="preprocessor">#define CONV1_IW 227</span></div>
<div class="line"><span class="preprocessor">#define CONV1_OH 55</span></div>
<div class="line"><span class="preprocessor">#define CONV1_OW 55</span></div>
<div class="line"><span class="preprocessor">#define CONV1_KS 11</span></div>
<div class="line"><span class="preprocessor">#define CONV1_STRIDE 4</span></div>
<div class="line"><span class="preprocessor">#define CONV1_PADDING 0</span></div>
<div class="line"><span class="preprocessor">#define CONV1_DILATION 1</span></div>
<div class="line"><span class="preprocessor">#define CONV1_GROUPS 1</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__engine.html#ga6ac1ba87052e33099253f1d21ddd0091">dnnl_graph_engine_kind_t</a> engine_kind = parse_engine_kind(argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (engine_kind == <a name="a0"></a><a class="code" href="group__dnnl__graph__api__engine.html#gga6ac1ba87052e33099253f1d21ddd0091a0e4015e41880cfeee945c30cbf346da2">dnnl_graph_gpu</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Don&#39;t support gpu now\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 1: Create allocator----------------&quot;</span>);</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__allocator.html#ga7e5ba6788922a000348e762ac8c88cc6">dnnl_graph_allocator_t</a> allocator;</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a name="a1"></a><a class="code" href="group__dnnl__graph__api__allocator.html#ga74b5186dcd04745ec511a2bd54ea8436">dnnl_graph_allocator_create</a>(&amp;allocator, allocate, deallocate));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 2: Create engine-------------------&quot;</span>);</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__engine.html#ga75225b86d0b48c36f94705755c2baef7">dnnl_graph_engine_t</a> engine;</div>
<div class="line">    <span class="keyword">const</span> int32_t device_id = 0;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a2"></a><a class="code" href="group__dnnl__graph__api__engine.html#ga2c1ce7b2c39efcdfbed4433f11eba964">dnnl_graph_engine_create_with_allocator</a>(</div>
<div class="line">            &amp;engine, engine_kind, device_id, allocator));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 3: Create op-----------------------&quot;</span>);</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__op.html#ga7a26d33507389facd89c77a7bd042834">dnnl_graph_op_t</a> conv0, conv1, bias_add0, bias_add1, batch_norm0,</div>
<div class="line">            batch_norm1, add0, relu0;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a3"></a><a class="code" href="group__dnnl__graph__api__op.html#ga4a7916455b8eed132a6981e60932d8ce">dnnl_graph_op_create</a>(</div>
<div class="line">            &amp;conv0, CONV0_ID, dnnl_graph_op_convolution, <span class="stringliteral">&quot;conv0&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga4a7916455b8eed132a6981e60932d8ce">dnnl_graph_op_create</a>(</div>
<div class="line">            &amp;conv1, CONV1_ID, dnnl_graph_op_convolution, <span class="stringliteral">&quot;conv1&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga4a7916455b8eed132a6981e60932d8ce">dnnl_graph_op_create</a>(</div>
<div class="line">            &amp;bias_add0, BIAS_ADD0_ID, dnnl_graph_op_bias_add, <span class="stringliteral">&quot;bias_add0&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga4a7916455b8eed132a6981e60932d8ce">dnnl_graph_op_create</a>(</div>
<div class="line">            &amp;bias_add1, BIAS_ADD1_ID, dnnl_graph_op_bias_add, <span class="stringliteral">&quot;bias_add1&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga4a7916455b8eed132a6981e60932d8ce">dnnl_graph_op_create</a>(&amp;batch_norm0, BATCH_NORM0_ID,</div>
<div class="line">            dnnl_graph_op_batch_norm_inference, <span class="stringliteral">&quot;batch_norm0&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga4a7916455b8eed132a6981e60932d8ce">dnnl_graph_op_create</a>(&amp;batch_norm1, BATCH_NORM1_ID,</div>
<div class="line">            dnnl_graph_op_batch_norm_inference, <span class="stringliteral">&quot;batch_norm1&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__op.html#ga4a7916455b8eed132a6981e60932d8ce">dnnl_graph_op_create</a>(&amp;add0, ADD0_ID, dnnl_graph_op_add, <span class="stringliteral">&quot;add0&quot;</span>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga4a7916455b8eed132a6981e60932d8ce">dnnl_graph_op_create</a>(</div>
<div class="line">            &amp;relu0, RELU0_ID, dnnl_graph_op_relu, <span class="stringliteral">&quot;relu0&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    int64_t conv0_stride[] = {CONV0_STRIDE, CONV0_STRIDE};</div>
<div class="line">    int64_t conv0_padding[] = {CONV0_PADDING, CONV0_PADDING};</div>
<div class="line">    int64_t conv0_dilation[] = {CONV0_DILATION, CONV0_DILATION};</div>
<div class="line">    int64_t conv0_groups[] = {CONV0_GROUPS};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a4"></a><a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv0, <a name="a5"></a><a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832aa736b04ce456907b8f02dd795a6902dd">dnnl_graph_op_attr_strides</a>, conv0_stride, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv0, <a name="a6"></a><a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832abbb2697080b0208aeae508831718db10">dnnl_graph_op_attr_pads_begin</a>, conv0_padding, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv0, <a name="a7"></a><a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832af3d7a3b02e2abe925d6560f95086828d">dnnl_graph_op_attr_pads_end</a>, conv0_padding, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv0, <a name="a8"></a><a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832ae4a124e36295a9d25e39840b4de42136">dnnl_graph_op_attr_dilations</a>, conv0_dilation, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a9"></a><a class="code" href="group__dnnl__graph__api__op.html#ga795bde1126c2c60cf16c06c596e87f95">dnnl_graph_op_set_attr_str</a>(</div>
<div class="line">            conv0, <a name="a10"></a><a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a3f5e3951f43b1bb7d58545a8b707b5e2">dnnl_graph_op_attr_data_format</a>, <span class="stringliteral">&quot;NCX&quot;</span>, 1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga795bde1126c2c60cf16c06c596e87f95">dnnl_graph_op_set_attr_str</a>(</div>
<div class="line">            conv0, <a name="a11"></a><a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a63b4144c146bde7650cc08cec08a8c7f">dnnl_graph_op_attr_filter_format</a>, <span class="stringliteral">&quot;OIX&quot;</span>, 1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv0, <a name="a12"></a><a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a5212f4a352a5d8197c3314b8232a12e2">dnnl_graph_op_attr_groups</a>, conv0_groups, 0));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga795bde1126c2c60cf16c06c596e87f95">dnnl_graph_op_set_attr_str</a>(</div>
<div class="line">            bias_add0, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a3f5e3951f43b1bb7d58545a8b707b5e2">dnnl_graph_op_attr_data_format</a>, <span class="stringliteral">&quot;NCX&quot;</span>, 1));</div>
<div class="line"> </div>
<div class="line">    int64_t conv1_stride[] = {CONV1_STRIDE, CONV1_STRIDE};</div>
<div class="line">    int64_t conv1_padding[] = {CONV1_PADDING, CONV1_PADDING};</div>
<div class="line">    int64_t conv1_dilation[] = {CONV1_DILATION, CONV1_DILATION};</div>
<div class="line">    int64_t conv1_groups[] = {CONV1_GROUPS};</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv1, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832aa736b04ce456907b8f02dd795a6902dd">dnnl_graph_op_attr_strides</a>, conv1_stride, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv1, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832abbb2697080b0208aeae508831718db10">dnnl_graph_op_attr_pads_begin</a>, conv1_padding, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv1, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832af3d7a3b02e2abe925d6560f95086828d">dnnl_graph_op_attr_pads_end</a>, conv1_padding, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv1, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832ae4a124e36295a9d25e39840b4de42136">dnnl_graph_op_attr_dilations</a>, conv1_dilation, 2));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga795bde1126c2c60cf16c06c596e87f95">dnnl_graph_op_set_attr_str</a>(</div>
<div class="line">            conv1, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a3f5e3951f43b1bb7d58545a8b707b5e2">dnnl_graph_op_attr_data_format</a>, <span class="stringliteral">&quot;NCX&quot;</span>, 1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga795bde1126c2c60cf16c06c596e87f95">dnnl_graph_op_set_attr_str</a>(</div>
<div class="line">            conv1, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a63b4144c146bde7650cc08cec08a8c7f">dnnl_graph_op_attr_filter_format</a>, <span class="stringliteral">&quot;OIX&quot;</span>, 1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a>(</div>
<div class="line">            conv1, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a5212f4a352a5d8197c3314b8232a12e2">dnnl_graph_op_attr_groups</a>, conv1_groups, 0));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga795bde1126c2c60cf16c06c596e87f95">dnnl_graph_op_set_attr_str</a>(</div>
<div class="line">            bias_add1, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a3f5e3951f43b1bb7d58545a8b707b5e2">dnnl_graph_op_attr_data_format</a>, <span class="stringliteral">&quot;NCX&quot;</span>, 1));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">float</span> epsilon = 0.0;</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a13"></a><a class="code" href="group__dnnl__graph__api__op.html#ga4a3b4c183bcb556aa853bb94a90307e6">dnnl_graph_op_set_attr_f32</a>(</div>
<div class="line">            batch_norm0, <a name="a14"></a><a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832ae648365c7c28fadc330a852be9e66dca">dnnl_graph_op_attr_epsilon</a>, &amp;epsilon, 0));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga4a3b4c183bcb556aa853bb94a90307e6">dnnl_graph_op_set_attr_f32</a>(</div>
<div class="line">            batch_norm1, <a class="code" href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832ae648365c7c28fadc330a852be9e66dca">dnnl_graph_op_attr_epsilon</a>, &amp;epsilon, 0));</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 4: Add OP to graph-----------------&quot;</span>);</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__graph.html#gaf5f09913d5fb57129a38a8bb779e1e71">dnnl_graph_graph_t</a> graph;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a15"></a><a class="code" href="group__dnnl__graph__api__graph.html#ga0c0190d7be5cacf079e7605ce9b4812b">dnnl_graph_graph_create</a>(&amp;graph, engine_kind));</div>
<div class="line">    {</div>
<div class="line">        <a name="_a16"></a><a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> conv0_src_desc, conv0_weight_desc,</div>
<div class="line">                conv0_dst_desc, conv0_bias_desc, bias_add0_dst_desc,</div>
<div class="line">                batch_norm0_scale_desc, batch_norm0_shift_desc,</div>
<div class="line">                batch_norm0_mean_desc, batch_norm0_variance_desc,</div>
<div class="line">                batch_norm0_dst_desc, conv1_src_desc, conv1_weight_desc,</div>
<div class="line">                conv1_dst_desc, conv1_bias_desc, bias_add1_dst_desc,</div>
<div class="line">                batch_norm1_scale_desc, batch_norm1_shift_desc,</div>
<div class="line">                batch_norm1_mean_desc, batch_norm1_variance_desc,</div>
<div class="line">                batch_norm1_dst_desc, add0_dst_desc, relu0_dst_desc;</div>
<div class="line">        DNNL_GRAPH_CHECK(<a name="a17"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;conv0_src_desc,</div>
<div class="line">                CONV0_SRC_ID, <a name="a18"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a name="a19"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a name="a20"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;conv0_weight_desc,</div>
<div class="line">                CONV0_WEI_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;conv0_dst_desc,</div>
<div class="line">                CONV0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;conv0_bias_desc,</div>
<div class="line">                CONV0_BIAS_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;bias_add0_dst_desc,</div>
<div class="line">                BIAS_ADD0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;batch_norm0_scale_desc,</div>
<div class="line">                BATCH_NORM0_SCALE_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;batch_norm0_shift_desc,</div>
<div class="line">                BATCH_NORM0_SHIFT_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;batch_norm0_mean_desc,</div>
<div class="line">                BATCH_NORM0_MEAN_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(</div>
<div class="line">                &amp;batch_norm0_variance_desc, BATCH_NORM0_VARIANCE_ID,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 0, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;batch_norm0_dst_desc,</div>
<div class="line">                BATCH_NORM0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;conv1_src_desc,</div>
<div class="line">                CONV1_SRC_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;conv1_weight_desc,</div>
<div class="line">                CONV1_WEI_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;conv1_dst_desc,</div>
<div class="line">                CONV1_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;conv1_bias_desc,</div>
<div class="line">                CONV1_BIAS_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;bias_add1_dst_desc,</div>
<div class="line">                BIAS_ADD1_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;batch_norm1_scale_desc,</div>
<div class="line">                BATCH_NORM1_SCALE_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;batch_norm1_shift_desc,</div>
<div class="line">                BATCH_NORM1_SHIFT_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;batch_norm1_mean_desc,</div>
<div class="line">                BATCH_NORM1_MEAN_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(</div>
<div class="line">                &amp;batch_norm1_variance_desc, BATCH_NORM1_VARIANCE_ID,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;batch_norm1_dst_desc,</div>
<div class="line">                BATCH_NORM1_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;add0_dst_desc,</div>
<div class="line">                ADD0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a>(&amp;relu0_dst_desc,</div>
<div class="line">                RELU0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, -1, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a>,</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line"> </div>
<div class="line">        DNNL_GRAPH_CHECK(<a name="a21"></a><a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(conv0, &amp;conv0_src_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(conv0, &amp;conv0_weight_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a name="a22"></a><a class="code" href="group__dnnl__graph__api__op.html#gae370d5f4aa7d88f1cad401068f5c7fdf">dnnl_graph_op_add_output</a>(conv0, &amp;conv0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(bias_add0, &amp;conv0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(bias_add0, &amp;conv0_bias_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gae370d5f4aa7d88f1cad401068f5c7fdf">dnnl_graph_op_add_output</a>(bias_add0, &amp;bias_add0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(batch_norm0, &amp;bias_add0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(batch_norm0, &amp;batch_norm0_scale_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(batch_norm0, &amp;batch_norm0_shift_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(batch_norm0, &amp;batch_norm0_mean_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(</div>
<div class="line">                batch_norm0, &amp;batch_norm0_variance_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gae370d5f4aa7d88f1cad401068f5c7fdf">dnnl_graph_op_add_output</a>(batch_norm0, &amp;batch_norm0_dst_desc));</div>
<div class="line"> </div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(conv1, &amp;conv1_src_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(conv1, &amp;conv1_weight_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gae370d5f4aa7d88f1cad401068f5c7fdf">dnnl_graph_op_add_output</a>(conv1, &amp;conv1_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(bias_add1, &amp;conv1_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(bias_add1, &amp;conv1_bias_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gae370d5f4aa7d88f1cad401068f5c7fdf">dnnl_graph_op_add_output</a>(bias_add1, &amp;bias_add1_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(batch_norm1, &amp;bias_add1_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(batch_norm1, &amp;batch_norm1_scale_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(batch_norm1, &amp;batch_norm1_shift_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(batch_norm1, &amp;batch_norm1_mean_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(</div>
<div class="line">                batch_norm1, &amp;batch_norm1_variance_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(</div>
<div class="line">                <a class="code" href="group__dnnl__graph__api__op.html#gae370d5f4aa7d88f1cad401068f5c7fdf">dnnl_graph_op_add_output</a>(batch_norm1, &amp;batch_norm1_dst_desc));</div>
<div class="line"> </div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(add0, &amp;batch_norm0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(add0, &amp;batch_norm1_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gae370d5f4aa7d88f1cad401068f5c7fdf">dnnl_graph_op_add_output</a>(add0, &amp;add0_dst_desc));</div>
<div class="line"> </div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a>(relu0, &amp;add0_dst_desc));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#gae370d5f4aa7d88f1cad401068f5c7fdf">dnnl_graph_op_add_output</a>(relu0, &amp;relu0_dst_desc));</div>
<div class="line"> </div>
<div class="line">        DNNL_GRAPH_CHECK(<a name="a23"></a><a class="code" href="group__dnnl__graph__api__graph.html#gaf3bd4cff1c11a993381993fee253a24d">dnnl_graph_add_op</a>(graph, conv0));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#gaf3bd4cff1c11a993381993fee253a24d">dnnl_graph_add_op</a>(graph, bias_add0));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#gaf3bd4cff1c11a993381993fee253a24d">dnnl_graph_add_op</a>(graph, batch_norm0));</div>
<div class="line"> </div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#gaf3bd4cff1c11a993381993fee253a24d">dnnl_graph_add_op</a>(graph, conv1));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#gaf3bd4cff1c11a993381993fee253a24d">dnnl_graph_add_op</a>(graph, bias_add1));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#gaf3bd4cff1c11a993381993fee253a24d">dnnl_graph_add_op</a>(graph, batch_norm1));</div>
<div class="line"> </div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#gaf3bd4cff1c11a993381993fee253a24d">dnnl_graph_add_op</a>(graph, add0));</div>
<div class="line">        DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__graph.html#gaf3bd4cff1c11a993381993fee253a24d">dnnl_graph_add_op</a>(graph, relu0));</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 5: Filter and get partition--------&quot;</span>);</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a name="a24"></a><a class="code" href="group__dnnl__graph__api__graph.html#ga6e244e39bef0def61eb0554f64c711aa">dnnl_graph_graph_filter</a>(graph, <a name="a25"></a><a class="code" href="group__dnnl__graph__api__partition.html#gga7e24b277b64600ef3a83dac2e8dfa83ba1489f3f9bb1262b58fa0bf0524d883a4">dnnl_graph_partition_policy_fusion</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> partitions_num;</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a name="a26"></a><a class="code" href="group__dnnl__graph__api__graph.html#gac8bcb45e44d15b5fd38a4625b4b5182f">dnnl_graph_graph_get_partition_num</a>(graph, &amp;partitions_num));</div>
<div class="line">    <span class="keywordflow">if</span> (partitions_num != 2) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: partitions number is not equal to %llu\n&quot;</span>,</div>
<div class="line">                (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>)partitions_num);</div>
<div class="line">        exit(1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__partition.html#ga2fdc3001503c7b586d5fc16637872ce4">dnnl_graph_partition_t</a> partitions[2];</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a27"></a><a class="code" href="group__dnnl__graph__api__partition.html#gac2d7658a571430060e30a5b30017bce8">dnnl_graph_partition_create</a>(&amp;partitions[0]));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__partition.html#gac2d7658a571430060e30a5b30017bce8">dnnl_graph_partition_create</a>(&amp;partitions[1]));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a28"></a><a class="code" href="group__dnnl__graph__api__graph.html#ga19b15aefbf47a518972fb6d843d50ea2">dnnl_graph_graph_get_partitions</a>(graph, 2, partitions));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 6: Compile the partitions----------&quot;</span>);</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga7578c6d5c3efdbaddd7b8e19429f546a">dnnl_graph_compiled_partition_t</a> cpartitions[2];</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a29"></a><a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga768f61f265d75c63ad6723203b638304">dnnl_graph_compiled_partition_create</a>(</div>
<div class="line">            &amp;cpartitions[0], partitions[0]));</div>
<div class="line"> </div>
<div class="line">    <a name="a30"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> conv1_src_dims = {BATCH, CONV1_IC, CONV1_IH, CONV1_IW};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> conv1_weight_dims</div>
<div class="line">            = {CONV1_OC, CONV1_IC, CONV1_KS, CONV1_KS};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> conv1_bias_dims = {CONV1_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> batch_norm1_scale_dims = {CONV1_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> batch_norm1_shift_dims = {CONV1_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> batch_norm1_mean_dims = {CONV1_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> batch_norm1_variance_dims = {CONV1_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> batch_norm1_dst_dims</div>
<div class="line">            = {BATCH, CONV1_OC, CONV1_OH, CONV1_OW};</div>
<div class="line">    <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> conv1_src_desc, conv1_weight_desc,</div>
<div class="line">            conv1_bias_desc, batch_norm1_scale_desc, batch_norm1_shift_desc,</div>
<div class="line">            batch_norm1_mean_desc, batch_norm1_variance_desc,</div>
<div class="line">            batch_norm1_dst_desc;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a31"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;conv1_src_desc,</div>
<div class="line">            CONV1_SRC_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4, conv1_src_dims,</div>
<div class="line">            <a name="a32"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;conv1_weight_desc, CONV1_WEI_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4,</div>
<div class="line">            conv1_weight_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;conv1_bias_desc,</div>
<div class="line">            CONV1_BIAS_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1, conv1_bias_dims,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;batch_norm1_scale_desc, BATCH_NORM1_SCALE_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1,</div>
<div class="line">            batch_norm1_scale_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;batch_norm1_shift_desc, BATCH_NORM1_SHIFT_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1,</div>
<div class="line">            batch_norm1_shift_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;batch_norm1_mean_desc, BATCH_NORM1_MEAN_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1,</div>
<div class="line">            batch_norm1_mean_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;batch_norm1_variance_desc, BATCH_NORM1_VARIANCE_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>,</div>
<div class="line">            1, batch_norm1_variance_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;batch_norm1_dst_desc, BATCH_NORM1_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4,</div>
<div class="line">            batch_norm1_dst_dims, <a name="a33"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694afc5178ef75924c4f130c70cf7b223203">dnnl_graph_layout_type_any</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> *partition0_inputs[]</div>
<div class="line">            = {&amp;conv1_src_desc, &amp;conv1_weight_desc, &amp;conv1_bias_desc,</div>
<div class="line">                    &amp;batch_norm1_scale_desc, &amp;batch_norm1_shift_desc,</div>
<div class="line">                    &amp;batch_norm1_mean_desc, &amp;batch_norm1_variance_desc};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> *partition0_outputs[]</div>
<div class="line">            = {&amp;batch_norm1_dst_desc};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a34"></a><a class="code" href="group__dnnl__graph__api__partition.html#ga2a9ed01fb04bf4be25f0f955af49c784">dnnl_graph_partition_compile</a>(partitions[0], cpartitions[0],</div>
<div class="line">            7, partition0_inputs, 1, partition0_outputs, engine));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a35"></a><a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], BATCH_NORM1_DST_ID, &amp;batch_norm1_dst_desc));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga768f61f265d75c63ad6723203b638304">dnnl_graph_compiled_partition_create</a>(</div>
<div class="line">            &amp;cpartitions[1], partitions[1]));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> conv0_src_dims = {BATCH, CONV0_IC, CONV0_IH, CONV0_IW};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> conv0_weight_dims</div>
<div class="line">            = {CONV0_OC, CONV0_IC, CONV0_KS, CONV0_KS};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> conv0_bias_dims = {CONV0_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> batch_norm0_scale_dims = {CONV0_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> batch_norm0_shift_dims = {CONV0_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> batch_norm0_mean_dims = {CONV0_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> batch_norm0_variance_dims = {CONV0_OC};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a> relu0_dst_dims = {BATCH, CONV0_OC, CONV0_OH, CONV0_OW};</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> conv0_src_desc, conv0_weight_desc,</div>
<div class="line">            conv0_bias_desc, batch_norm0_scale_desc, batch_norm0_shift_desc,</div>
<div class="line">            batch_norm0_mean_desc, batch_norm0_variance_desc, add0_src1_desc,</div>
<div class="line">            relu0_dst_desc;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;conv0_src_desc,</div>
<div class="line">            CONV0_SRC_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4, conv0_src_dims,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;conv0_weight_desc, CONV0_WEI_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4,</div>
<div class="line">            conv0_weight_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;conv0_bias_desc,</div>
<div class="line">            CONV0_BIAS_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1, conv0_bias_dims,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;batch_norm0_scale_desc, BATCH_NORM0_SCALE_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1,</div>
<div class="line">            batch_norm0_scale_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;batch_norm0_shift_desc, BATCH_NORM0_SHIFT_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1,</div>
<div class="line">            batch_norm0_shift_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;batch_norm0_mean_desc, BATCH_NORM0_MEAN_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 1,</div>
<div class="line">            batch_norm0_mean_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(</div>
<div class="line">            &amp;batch_norm0_variance_desc, BATCH_NORM0_VARIANCE_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>,</div>
<div class="line">            1, batch_norm0_variance_dims, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;add0_src1_desc,</div>
<div class="line">            ADD0_SRC1_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4, batch_norm1_dst_dims,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a>(&amp;relu0_dst_desc,</div>
<div class="line">            RELU0_DST_ID, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a>, 4, relu0_dst_dims,</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a>, <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a>));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], ADD0_SRC1_ID, &amp;add0_src1_desc));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> *partition1_inputs[] = {&amp;conv0_src_desc,</div>
<div class="line">            &amp;conv0_weight_desc, &amp;conv0_bias_desc, &amp;batch_norm0_scale_desc,</div>
<div class="line">            &amp;batch_norm0_shift_desc, &amp;batch_norm0_mean_desc,</div>
<div class="line">            &amp;batch_norm0_variance_desc, &amp;add0_src1_desc};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> *partition1_outputs[] = {&amp;relu0_dst_desc};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__partition.html#ga2a9ed01fb04bf4be25f0f955af49c784">dnnl_graph_partition_compile</a>(partitions[1], cpartitions[1],</div>
<div class="line">            8, partition1_inputs, 1, partition1_outputs, engine));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 7: Alloc memory and execute--------&quot;</span>);</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__stream.html#ga684f4b56ffdd4df9a6b2a3dc53c75530">dnnl_graph_stream_t</a> stream = NULL;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a36"></a><a class="code" href="group__dnnl__graph__api__stream.html#gae61f6ea3edc15bfc89c1f1e7c347e932">dnnl_graph_stream_create</a>(&amp;stream, engine));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> conv1_src_size, conv1_weight_size, conv1_bias_size,</div>
<div class="line">            batch_norm1_scale_size, batch_norm1_shift_size,</div>
<div class="line">            batch_norm1_mean_size, batch_norm1_variance_size,</div>
<div class="line">            batch_norm1_dst_size;</div>
<div class="line">    <span class="keywordtype">float</span> *conv1_src_data = NULL, *conv1_weight_data = NULL,</div>
<div class="line">          *conv1_bias_data = NULL, *batch_norm1_scale_data = NULL,</div>
<div class="line">          *batch_norm1_shift_data = NULL, *batch_norm1_mean_data = NULL,</div>
<div class="line">          *batch_norm1_variance_data = NULL, *batch_norm1_dst_data = NULL;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a> temp;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], CONV1_SRC_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a name="a37"></a><a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv1_src_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], CONV1_WEI_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv1_weight_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], CONV1_BIAS_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv1_bias_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], BATCH_NORM1_SCALE_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(</div>
<div class="line">            &amp;temp, &amp;batch_norm1_scale_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], BATCH_NORM1_SHIFT_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(</div>
<div class="line">            &amp;temp, &amp;batch_norm1_shift_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], BATCH_NORM1_MEAN_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(</div>
<div class="line">            &amp;temp, &amp;batch_norm1_mean_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], BATCH_NORM1_VARIANCE_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(</div>
<div class="line">            &amp;temp, &amp;batch_norm1_variance_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[0], BATCH_NORM1_DST_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(</div>
<div class="line">            &amp;temp, &amp;batch_norm1_dst_size));</div>
<div class="line"> </div>
<div class="line">    conv1_src_data = (<span class="keywordtype">float</span> *)malloc(conv1_src_size);</div>
<div class="line">    conv1_weight_data = (<span class="keywordtype">float</span> *)malloc(conv1_weight_size);</div>
<div class="line">    conv1_bias_data = (<span class="keywordtype">float</span> *)malloc(conv1_bias_size);</div>
<div class="line">    batch_norm1_scale_data = (<span class="keywordtype">float</span> *)malloc(batch_norm1_scale_size);</div>
<div class="line">    batch_norm1_shift_data = (<span class="keywordtype">float</span> *)malloc(batch_norm1_shift_size);</div>
<div class="line">    batch_norm1_mean_data = (<span class="keywordtype">float</span> *)malloc(batch_norm1_mean_size);</div>
<div class="line">    batch_norm1_variance_data = (<span class="keywordtype">float</span> *)malloc(batch_norm1_variance_size);</div>
<div class="line">    batch_norm1_dst_data = (<span class="keywordtype">float</span> *)malloc(batch_norm1_dst_size);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!conv1_src_data || !conv1_weight_data || !conv1_bias_data</div>
<div class="line">            || !batch_norm1_scale_data || !batch_norm1_shift_data</div>
<div class="line">            || !batch_norm1_mean_data || !batch_norm1_variance_data</div>
<div class="line">            || !batch_norm1_dst_data) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: alloc memory failed\n&quot;</span>);</div>
<div class="line">        exit(1);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv1_src_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv1_src_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv1_weight_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv1_weight_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv1_bias_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv1_bias_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; batch_norm1_scale_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        batch_norm1_scale_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; batch_norm1_shift_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        batch_norm1_shift_data[i] = 0.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; batch_norm1_mean_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        batch_norm1_mean_data[i] = 0.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; batch_norm1_variance_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        batch_norm1_variance_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__tensor.html#ga77c7c6168286b2a791ecea37336d25d4">dnnl_graph_tensor_t</a> conv1_src, conv1_weight, conv1_bias, batch_norm1_scale,</div>
<div class="line">            batch_norm1_shift, batch_norm1_mean, batch_norm1_variance,</div>
<div class="line">            batch_norm1_dst;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a38"></a><a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv1_src, &amp;conv1_src_desc, engine, conv1_src_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv1_weight, &amp;conv1_weight_desc, engine, conv1_weight_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv1_bias, &amp;conv1_bias_desc, engine, conv1_bias_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(&amp;batch_norm1_scale,</div>
<div class="line">            &amp;batch_norm1_scale_desc, engine, batch_norm1_scale_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(&amp;batch_norm1_shift,</div>
<div class="line">            &amp;batch_norm1_shift_desc, engine, batch_norm1_shift_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(&amp;batch_norm1_mean,</div>
<div class="line">            &amp;batch_norm1_mean_desc, engine, batch_norm1_mean_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(&amp;batch_norm1_variance,</div>
<div class="line">            &amp;batch_norm1_variance_desc, engine, batch_norm1_variance_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(&amp;batch_norm1_dst,</div>
<div class="line">            &amp;batch_norm1_dst_desc, engine, batch_norm1_dst_data));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__tensor.html#ga501fef96950f38448cb326c776e8d068">const_dnnl_graph_tensor_t</a> cpartition0_inputs[]</div>
<div class="line">            = {conv1_src, conv1_weight, conv1_bias, batch_norm1_scale,</div>
<div class="line">                    batch_norm1_shift, batch_norm1_mean, batch_norm1_variance};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__tensor.html#ga501fef96950f38448cb326c776e8d068">const_dnnl_graph_tensor_t</a> cpartition0_outputs[] = {batch_norm1_dst};</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a39"></a><a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1858ce8665ea011cfffce03d6c427e64">dnnl_graph_compiled_partition_execute</a>(cpartitions[0],</div>
<div class="line">            stream, 7, cpartition0_inputs, 1, cpartition0_outputs));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> conv0_src_size, conv0_weight_size, conv0_bias_size,</div>
<div class="line">            batch_norm0_scale_size, batch_norm0_shift_size,</div>
<div class="line">            batch_norm0_mean_size, batch_norm0_variance_size, add0_src1_size,</div>
<div class="line">            relu0_dst_size;</div>
<div class="line">    <span class="keywordtype">float</span> *conv0_src_data = NULL, *conv0_weight_data = NULL,</div>
<div class="line">          *conv0_bias_data = NULL, *batch_norm0_scale_data = NULL,</div>
<div class="line">          *batch_norm0_shift_data = NULL, *batch_norm0_mean_data = NULL,</div>
<div class="line">          *batch_norm0_variance_data = NULL, *add0_src1_data = NULL,</div>
<div class="line">          *relu0_dst_data = NULL;</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], CONV0_SRC_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv0_src_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], CONV0_WEI_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv0_weight_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], CONV0_BIAS_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;conv0_bias_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], BATCH_NORM0_SCALE_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(</div>
<div class="line">            &amp;temp, &amp;batch_norm0_scale_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], BATCH_NORM0_SHIFT_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(</div>
<div class="line">            &amp;temp, &amp;batch_norm0_shift_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], BATCH_NORM0_MEAN_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(</div>
<div class="line">            &amp;temp, &amp;batch_norm0_mean_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], BATCH_NORM0_VARIANCE_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(</div>
<div class="line">            &amp;temp, &amp;batch_norm0_variance_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], ADD0_SRC1_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;add0_src1_size));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a>(</div>
<div class="line">            cpartitions[1], RELU0_DST_ID, &amp;temp));</div>
<div class="line">    DNNL_GRAPH_CHECK(</div>
<div class="line">            <a class="code" href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a>(&amp;temp, &amp;relu0_dst_size));</div>
<div class="line"> </div>
<div class="line">    conv0_src_data = (<span class="keywordtype">float</span> *)malloc(conv0_src_size);</div>
<div class="line">    conv0_weight_data = (<span class="keywordtype">float</span> *)malloc(conv0_weight_size);</div>
<div class="line">    conv0_bias_data = (<span class="keywordtype">float</span> *)malloc(conv0_bias_size);</div>
<div class="line">    batch_norm0_scale_data = (<span class="keywordtype">float</span> *)malloc(batch_norm0_scale_size);</div>
<div class="line">    batch_norm0_shift_data = (<span class="keywordtype">float</span> *)malloc(batch_norm0_shift_size);</div>
<div class="line">    batch_norm0_mean_data = (<span class="keywordtype">float</span> *)malloc(batch_norm0_mean_size);</div>
<div class="line">    batch_norm0_variance_data = (<span class="keywordtype">float</span> *)malloc(batch_norm0_variance_size);</div>
<div class="line">    add0_src1_data = (<span class="keywordtype">float</span> *)malloc(add0_src1_size);</div>
<div class="line">    relu0_dst_data = (<span class="keywordtype">float</span> *)malloc(relu0_dst_size);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!conv0_src_data || !conv0_weight_data || !conv0_bias_data</div>
<div class="line">            || !batch_norm0_scale_data || !batch_norm0_shift_data</div>
<div class="line">            || !batch_norm0_mean_data || !batch_norm0_variance_data</div>
<div class="line">            || !add0_src1_data || !relu0_dst_data) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: alloc memory failed\n&quot;</span>);</div>
<div class="line">        exit(1);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv0_src_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv0_src_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv0_weight_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv0_weight_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; conv0_bias_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        conv0_bias_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; batch_norm0_scale_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        batch_norm0_scale_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; batch_norm0_shift_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        batch_norm0_shift_data[i] = 0.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; batch_norm0_mean_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        batch_norm0_mean_data[i] = 0.0f;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; batch_norm0_variance_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        batch_norm0_variance_data[i] = 1.0f;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__tensor.html#ga77c7c6168286b2a791ecea37336d25d4">dnnl_graph_tensor_t</a> conv0_src, conv0_weight, conv0_bias, batch_norm0_scale,</div>
<div class="line">            batch_norm0_shift, batch_norm0_mean, batch_norm0_variance,</div>
<div class="line">            relu0_dst;</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv0_src, &amp;conv0_src_desc, engine, conv0_src_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv0_weight, &amp;conv0_weight_desc, engine, conv0_weight_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;conv0_bias, &amp;conv0_bias_desc, engine, conv0_bias_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(&amp;batch_norm0_scale,</div>
<div class="line">            &amp;batch_norm0_scale_desc, engine, batch_norm0_scale_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(&amp;batch_norm0_shift,</div>
<div class="line">            &amp;batch_norm0_shift_desc, engine, batch_norm0_shift_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(&amp;batch_norm0_mean,</div>
<div class="line">            &amp;batch_norm0_mean_desc, engine, batch_norm0_mean_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(&amp;batch_norm0_variance,</div>
<div class="line">            &amp;batch_norm0_variance_desc, engine, batch_norm0_variance_data));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a>(</div>
<div class="line">            &amp;relu0_dst, &amp;relu0_dst_desc, engine, relu0_dst_data));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__tensor.html#ga501fef96950f38448cb326c776e8d068">const_dnnl_graph_tensor_t</a> cpartition1_inputs[] = {conv0_src, conv0_weight,</div>
<div class="line">            conv0_bias, batch_norm0_scale, batch_norm0_shift, batch_norm0_mean,</div>
<div class="line">            batch_norm0_variance, batch_norm1_dst};</div>
<div class="line">    <a class="code" href="group__dnnl__graph__api__tensor.html#ga501fef96950f38448cb326c776e8d068">const_dnnl_graph_tensor_t</a> cpartition1_outputs[] = {relu0_dst};</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga1858ce8665ea011cfffce03d6c427e64">dnnl_graph_compiled_partition_execute</a>(cpartitions[1],</div>
<div class="line">            stream, 8, cpartition1_inputs, 1, cpartition1_outputs));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a40"></a><a class="code" href="group__dnnl__graph__api__stream.html#ga6b202d604d477ff256a88f812bb08e09">dnnl_graph_stream_destroy</a>(stream));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Step 8: Check correctness---------------&quot;</span>);</div>
<div class="line">    <span class="keywordtype">float</span> excepted_result = (1 * 11 * 11 * 3 + <span class="comment">/* conv0 bias */</span> 1.0f) * 2;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; relu0_dst_size / <span class="keyword">sizeof</span>(float); i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (fabsf(excepted_result - relu0_dst_data[i]) &gt; 1e-6f) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Error: output result is not equal to excepted &quot;</span></div>
<div class="line">                   <span class="stringliteral">&quot;results\n&quot;</span>);</div>
<div class="line">            exit(1);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Success!\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    free(conv0_src_data);</div>
<div class="line">    free(conv0_weight_data);</div>
<div class="line">    free(conv0_bias_data);</div>
<div class="line">    free(batch_norm0_scale_data);</div>
<div class="line">    free(batch_norm0_shift_data);</div>
<div class="line">    free(batch_norm0_mean_data);</div>
<div class="line">    free(batch_norm0_variance_data);</div>
<div class="line"> </div>
<div class="line">    free(conv1_src_data);</div>
<div class="line">    free(conv1_weight_data);</div>
<div class="line">    free(conv1_bias_data);</div>
<div class="line">    free(batch_norm1_scale_data);</div>
<div class="line">    free(batch_norm1_shift_data);</div>
<div class="line">    free(batch_norm1_mean_data);</div>
<div class="line">    free(batch_norm1_variance_data);</div>
<div class="line">    free(batch_norm1_dst_data);</div>
<div class="line"> </div>
<div class="line">    free(add0_src1_data);</div>
<div class="line">    free(relu0_dst_data);</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a41"></a><a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(conv0_src));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(conv0_weight));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(conv0_bias));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(batch_norm0_scale));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(batch_norm0_shift));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(batch_norm0_mean));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(batch_norm0_variance));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(conv1_src));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(conv1_weight));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(conv1_bias));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(batch_norm1_scale));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(batch_norm1_shift));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(batch_norm1_mean));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(batch_norm1_variance));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(batch_norm1_dst));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a>(relu0_dst));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a42"></a><a class="code" href="group__dnnl__graph__api__partition.html#gab0ef5a8addc4e338f85b7ae7dc2c10db">dnnl_graph_partition_destroy</a>(partitions[0]));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__partition.html#gab0ef5a8addc4e338f85b7ae7dc2c10db">dnnl_graph_partition_destroy</a>(partitions[1]));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a43"></a><a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga0fb55ede4040a57198a9f771d0de943a">dnnl_graph_compiled_partition_destroy</a>(cpartitions[0]));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__compiled__partition.html#ga0fb55ede4040a57198a9f771d0de943a">dnnl_graph_compiled_partition_destroy</a>(cpartitions[1]));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a44"></a><a class="code" href="group__dnnl__graph__api__op.html#ga6ca9999cbf0383f2616f47fad4dd1a44">dnnl_graph_op_destroy</a>(conv0));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga6ca9999cbf0383f2616f47fad4dd1a44">dnnl_graph_op_destroy</a>(bias_add0));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga6ca9999cbf0383f2616f47fad4dd1a44">dnnl_graph_op_destroy</a>(batch_norm0));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga6ca9999cbf0383f2616f47fad4dd1a44">dnnl_graph_op_destroy</a>(conv1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga6ca9999cbf0383f2616f47fad4dd1a44">dnnl_graph_op_destroy</a>(bias_add1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga6ca9999cbf0383f2616f47fad4dd1a44">dnnl_graph_op_destroy</a>(batch_norm1));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga6ca9999cbf0383f2616f47fad4dd1a44">dnnl_graph_op_destroy</a>(add0));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a class="code" href="group__dnnl__graph__api__op.html#ga6ca9999cbf0383f2616f47fad4dd1a44">dnnl_graph_op_destroy</a>(relu0));</div>
<div class="line"> </div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a45"></a><a class="code" href="group__dnnl__graph__api__graph.html#ga3fdebb0e00fc31ad4a6fa7ad5c495289">dnnl_graph_graph_destroy</a>(graph));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a46"></a><a class="code" href="group__dnnl__graph__api__engine.html#gad40bec6c0922105b22af4cf82a4489a9">dnnl_graph_engine_destroy</a>(engine));</div>
<div class="line">    DNNL_GRAPH_CHECK(<a name="a47"></a><a class="code" href="group__dnnl__graph__api__allocator.html#ga2d5f2e6eb83fb78a3d2ad351efa5c2bd">dnnl_graph_allocator_destroy</a>(allocator));</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Example pass\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="adnnl__graph_8h_html"><div class="ttname"><a href="dnnl__graph_8h.html">dnnl_graph.h</a></div><div class="ttdoc">C API.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__allocator_html_ga2d5f2e6eb83fb78a3d2ad351efa5c2bd"><div class="ttname"><a href="group__dnnl__graph__api__allocator.html#ga2d5f2e6eb83fb78a3d2ad351efa5c2bd">dnnl_graph_allocator_destroy</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_allocator_destroy(dnnl_graph_allocator_t allocator)</div><div class="ttdoc">Destroys an allocator.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__allocator_html_ga74b5186dcd04745ec511a2bd54ea8436"><div class="ttname"><a href="group__dnnl__graph__api__allocator.html#ga74b5186dcd04745ec511a2bd54ea8436">dnnl_graph_allocator_create</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_allocator_create(dnnl_graph_allocator_t *allocator, dnnl_graph_host_allocate_f host_malloc, dnnl_graph_host_deallocate_f host_free)</div><div class="ttdoc">Creates a host allocator with the given allocation and deallocation call-back function pointers.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__allocator_html_ga7e5ba6788922a000348e762ac8c88cc6"><div class="ttname"><a href="group__dnnl__graph__api__allocator.html#ga7e5ba6788922a000348e762ac8c88cc6">dnnl_graph_allocator_t</a></div><div class="ttdeci">struct dnnl_graph_allocator * dnnl_graph_allocator_t</div><div class="ttdoc">An allocator handle.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:633</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__compiled__partition_html_ga0fb55ede4040a57198a9f771d0de943a"><div class="ttname"><a href="group__dnnl__graph__api__compiled__partition.html#ga0fb55ede4040a57198a9f771d0de943a">dnnl_graph_compiled_partition_destroy</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_compiled_partition_destroy(dnnl_graph_compiled_partition_t compiled_partition)</div><div class="ttdoc">Destroys a compiled partition.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__compiled__partition_html_ga1858ce8665ea011cfffce03d6c427e64"><div class="ttname"><a href="group__dnnl__graph__api__compiled__partition.html#ga1858ce8665ea011cfffce03d6c427e64">dnnl_graph_compiled_partition_execute</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_compiled_partition_execute(const_dnnl_graph_compiled_partition_t compiled_partition, dnnl_graph_stream_t stream, size_t num_inputs, const_dnnl_graph_tensor_t *inputs, size_t num_outputs, const_dnnl_graph_tensor_t *outputs)</div><div class="ttdoc">Executes a compiled partition.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__compiled__partition_html_ga1b07c0a7705e4f9cea46b8fed981b5d1"><div class="ttname"><a href="group__dnnl__graph__api__compiled__partition.html#ga1b07c0a7705e4f9cea46b8fed981b5d1">dnnl_graph_compiled_partition_query_logical_tensor</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_compiled_partition_query_logical_tensor(const_dnnl_graph_compiled_partition_t compiled_partition, size_t tid, dnnl_graph_logical_tensor_t *lt)</div><div class="ttdoc">Queries an input or output logical tensor according to tensor ID.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__compiled__partition_html_ga7578c6d5c3efdbaddd7b8e19429f546a"><div class="ttname"><a href="group__dnnl__graph__api__compiled__partition.html#ga7578c6d5c3efdbaddd7b8e19429f546a">dnnl_graph_compiled_partition_t</a></div><div class="ttdeci">struct dnnl_graph_compiled_partition * dnnl_graph_compiled_partition_t</div><div class="ttdoc">A compiled partition handle.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:664</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__compiled__partition_html_ga768f61f265d75c63ad6723203b638304"><div class="ttname"><a href="group__dnnl__graph__api__compiled__partition.html#ga768f61f265d75c63ad6723203b638304">dnnl_graph_compiled_partition_create</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_compiled_partition_create(dnnl_graph_compiled_partition_t *compiled_partition, dnnl_graph_partition_t partition)</div><div class="ttdoc">Creates a new compiled partition handle.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_ga2c1ce7b2c39efcdfbed4433f11eba964"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#ga2c1ce7b2c39efcdfbed4433f11eba964">dnnl_graph_engine_create_with_allocator</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_engine_create_with_allocator(dnnl_graph_engine_t *engine, dnnl_graph_engine_kind_t kind, size_t index, const_dnnl_graph_allocator_t alloc)</div><div class="ttdoc">Creates an engine with specified engine kind, device index, and allocator.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_ga6ac1ba87052e33099253f1d21ddd0091"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#ga6ac1ba87052e33099253f1d21ddd0091">dnnl_graph_engine_kind_t</a></div><div class="ttdeci">dnnl_graph_engine_kind_t</div><div class="ttdoc">Kind for engine.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:326</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_ga75225b86d0b48c36f94705755c2baef7"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#ga75225b86d0b48c36f94705755c2baef7">dnnl_graph_engine_t</a></div><div class="ttdeci">struct dnnl_graph_engine * dnnl_graph_engine_t</div><div class="ttdoc">An engine handle.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:339</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_gad40bec6c0922105b22af4cf82a4489a9"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#gad40bec6c0922105b22af4cf82a4489a9">dnnl_graph_engine_destroy</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_engine_destroy(dnnl_graph_engine_t engine)</div><div class="ttdoc">Destroys an engine.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__engine_html_gga6ac1ba87052e33099253f1d21ddd0091a0e4015e41880cfeee945c30cbf346da2"><div class="ttname"><a href="group__dnnl__graph__api__engine.html#gga6ac1ba87052e33099253f1d21ddd0091a0e4015e41880cfeee945c30cbf346da2">dnnl_graph_gpu</a></div><div class="ttdeci">@ dnnl_graph_gpu</div><div class="ttdoc">GPU engine.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:332</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_ga0c0190d7be5cacf079e7605ce9b4812b"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#ga0c0190d7be5cacf079e7605ce9b4812b">dnnl_graph_graph_create</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_graph_create(dnnl_graph_graph_t *graph, dnnl_graph_engine_kind_t engine_kind)</div><div class="ttdoc">Creates a new empty graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_ga19b15aefbf47a518972fb6d843d50ea2"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#ga19b15aefbf47a518972fb6d843d50ea2">dnnl_graph_graph_get_partitions</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_graph_get_partitions(dnnl_graph_graph_t graph, size_t num, dnnl_graph_partition_t *partition)</div><div class="ttdoc">Returns the partitions from a filtered graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_ga3fdebb0e00fc31ad4a6fa7ad5c495289"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#ga3fdebb0e00fc31ad4a6fa7ad5c495289">dnnl_graph_graph_destroy</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_graph_destroy(dnnl_graph_graph_t graph)</div><div class="ttdoc">Destroys a graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_ga6e244e39bef0def61eb0554f64c711aa"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#ga6e244e39bef0def61eb0554f64c711aa">dnnl_graph_graph_filter</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_graph_filter(dnnl_graph_graph_t graph, dnnl_graph_partition_policy_t policy)</div><div class="ttdoc">Filters a graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_gac8bcb45e44d15b5fd38a4625b4b5182f"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#gac8bcb45e44d15b5fd38a4625b4b5182f">dnnl_graph_graph_get_partition_num</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_graph_get_partition_num(const_dnnl_graph_graph_t graph, size_t *num)</div><div class="ttdoc">Returns the number of partitions of a graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_gaf3bd4cff1c11a993381993fee253a24d"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#gaf3bd4cff1c11a993381993fee253a24d">dnnl_graph_add_op</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_add_op(dnnl_graph_graph_t graph, dnnl_graph_op_t op)</div><div class="ttdoc">Adds an operation into a graph.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__graph_html_gaf5f09913d5fb57129a38a8bb779e1e71"><div class="ttname"><a href="group__dnnl__graph__api__graph.html#gaf5f09913d5fb57129a38a8bb779e1e71">dnnl_graph_graph_t</a></div><div class="ttdeci">struct dnnl_graph_graph * dnnl_graph_graph_t</div><div class="ttdoc">A graph handle.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:367</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_ga4eea2b5b4b7da3250ab8a0778e79df92"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#ga4eea2b5b4b7da3250ab8a0778e79df92">dnnl_graph_logical_tensor_get_mem_size</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_logical_tensor_get_mem_size(const dnnl_graph_logical_tensor_t *logical_tensor, size_t *size)</div><div class="ttdoc">Returns the memory size described by the logical tensor.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_ga821b1d0503e5708adc28f66ef56a5a5a"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#ga821b1d0503e5708adc28f66ef56a5a5a">dnnl_graph_logical_tensor_init</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_logical_tensor_init(dnnl_graph_logical_tensor_t *logical_tensor, size_t tid, dnnl_graph_data_type_t dtype, int32_t ndims, dnnl_graph_layout_type_t ltype, dnnl_graph_tensor_property_t ptype)</div><div class="ttdoc">Initializes a logical tensor with id, data type, number of dimensions, layout type,...</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gae8b7ed79f63a8cbab937d4d66cd75255"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gae8b7ed79f63a8cbab937d4d66cd75255">dnnl_graph_dims_t</a></div><div class="ttdeci">dnnl_graph_dim_t dnnl_graph_dims_t[DNNL_GRAPH_MAX_NDIMS]</div><div class="ttdoc">A type to describe tensor dimensions.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:78</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gaff45ff0b8efccb42768069c40428a406"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gaff45ff0b8efccb42768069c40428a406">dnnl_graph_logical_tensor_init_with_dims</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_logical_tensor_init_with_dims(dnnl_graph_logical_tensor_t *logical_tensor, size_t tid, dnnl_graph_data_type_t dtype, int32_t ndims, const dnnl_graph_dims_t dims, dnnl_graph_layout_type_t ltype, dnnl_graph_tensor_property_t ptype)</div><div class="ttdoc">Initializes a logical tensor with basic information and dims.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694a77482f385c4f7969285a99a06a3f3637">dnnl_graph_layout_type_undef</a></div><div class="ttdeci">@ dnnl_graph_layout_type_undef</div><div class="ttdoc">Undefined layout type.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:111</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694aa9ea14026cc47aafffdcb92c00a1b1ea">dnnl_graph_layout_type_strided</a></div><div class="ttdeci">@ dnnl_graph_layout_type_strided</div><div class="ttdoc">Strided means that the layout of a tensor is determined by the strides field in the logical tensor.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:117</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_gga5b552d8a81835eb955253410bf012694afc5178ef75924c4f130c70cf7b223203"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#gga5b552d8a81835eb955253410bf012694afc5178ef75924c4f130c70cf7b223203">dnnl_graph_layout_type_any</a></div><div class="ttdeci">@ dnnl_graph_layout_type_any</div><div class="ttdoc">Any means to let the library to decide the layout for a tensor during partition compilation.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:114</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#ggaad147cf0f6df4b97b1c4a55b5595128ba62ac0f4fac4045316db2f725944e6c61">dnnl_graph_f32</a></div><div class="ttdeci">@ dnnl_graph_f32</div><div class="ttdoc">32-bit/single-precision floating point.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:89</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__logical__tensor_html_ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7"><div class="ttname"><a href="group__dnnl__graph__api__logical__tensor.html#ggadf98ec2238dd9001c6fe7870ebf1b19faa02e5493848853a9bf77982d2fa56ab7">dnnl_graph_tensor_property_undef</a></div><div class="ttdeci">@ dnnl_graph_tensor_property_undef</div><div class="ttdoc">Undefined tensor property.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:127</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_ga1301109da125fafe30084e054da5fa1c"><div class="ttname"><a href="group__dnnl__graph__api__op.html#ga1301109da125fafe30084e054da5fa1c">dnnl_graph_op_set_attr_s64</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_op_set_attr_s64(dnnl_graph_op_t op, dnnl_graph_op_attr_t name, const int64_t *value, size_t value_len)</div><div class="ttdoc">Sets integer attribute to an op.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_ga4a3b4c183bcb556aa853bb94a90307e6"><div class="ttname"><a href="group__dnnl__graph__api__op.html#ga4a3b4c183bcb556aa853bb94a90307e6">dnnl_graph_op_set_attr_f32</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_op_set_attr_f32(dnnl_graph_op_t op, dnnl_graph_op_attr_t name, const float *value, size_t value_len)</div><div class="ttdoc">Sets floating point attribute to an op.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_ga4a7916455b8eed132a6981e60932d8ce"><div class="ttname"><a href="group__dnnl__graph__api__op.html#ga4a7916455b8eed132a6981e60932d8ce">dnnl_graph_op_create</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_op_create(dnnl_graph_op_t *op, size_t id, dnnl_graph_op_kind_t kind, const char *verbose_name)</div><div class="ttdoc">Initializes an op with unique id, kind, and name.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_ga6ca9999cbf0383f2616f47fad4dd1a44"><div class="ttname"><a href="group__dnnl__graph__api__op.html#ga6ca9999cbf0383f2616f47fad4dd1a44">dnnl_graph_op_destroy</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_op_destroy(dnnl_graph_op_t op)</div><div class="ttdoc">Destroys an op.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_ga795bde1126c2c60cf16c06c596e87f95"><div class="ttname"><a href="group__dnnl__graph__api__op.html#ga795bde1126c2c60cf16c06c596e87f95">dnnl_graph_op_set_attr_str</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_op_set_attr_str(dnnl_graph_op_t op, dnnl_graph_op_attr_t name, const char *value, size_t value_len)</div><div class="ttdoc">Sets string attribute to an op.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_ga7a26d33507389facd89c77a7bd042834"><div class="ttname"><a href="group__dnnl__graph__api__op.html#ga7a26d33507389facd89c77a7bd042834">dnnl_graph_op_t</a></div><div class="ttdeci">struct dnnl_graph_op * dnnl_graph_op_t</div><div class="ttdoc">An operation handle.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:605</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gaab00d913d772ab492d850e1b7091644a"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gaab00d913d772ab492d850e1b7091644a">dnnl_graph_op_add_input</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_op_add_input(dnnl_graph_op_t op, const dnnl_graph_logical_tensor_t *input)</div><div class="ttdoc">Adds an input logical tensor to an operation.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gae370d5f4aa7d88f1cad401068f5c7fdf"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gae370d5f4aa7d88f1cad401068f5c7fdf">dnnl_graph_op_add_output</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_op_add_output(dnnl_graph_op_t op, const dnnl_graph_logical_tensor_t *output)</div><div class="ttdoc">Adds an output logical tensor to the op.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga106f069a858125ba0dd4d585b8f4e832a3f5e3951f43b1bb7d58545a8b707b5e2"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a3f5e3951f43b1bb7d58545a8b707b5e2">dnnl_graph_op_attr_data_format</a></div><div class="ttdeci">@ dnnl_graph_op_attr_data_format</div><div class="ttdoc">Specifies a data_format of an op. The value can be &quot;NCX&quot; or &quot;NXC&quot;.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:586</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga106f069a858125ba0dd4d585b8f4e832a5212f4a352a5d8197c3314b8232a12e2"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a5212f4a352a5d8197c3314b8232a12e2">dnnl_graph_op_attr_groups</a></div><div class="ttdeci">@ dnnl_graph_op_attr_groups</div><div class="ttdoc">Specifies a groups attribute to an op.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:517</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga106f069a858125ba0dd4d585b8f4e832a63b4144c146bde7650cc08cec08a8c7f"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832a63b4144c146bde7650cc08cec08a8c7f">dnnl_graph_op_attr_filter_format</a></div><div class="ttdeci">@ dnnl_graph_op_attr_filter_format</div><div class="ttdoc">Specifies a filter_format of an op. The value can be &quot;OIX&quot; or &quot;XIO&quot;.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:588</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga106f069a858125ba0dd4d585b8f4e832aa736b04ce456907b8f02dd795a6902dd"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832aa736b04ce456907b8f02dd795a6902dd">dnnl_graph_op_attr_strides</a></div><div class="ttdeci">@ dnnl_graph_op_attr_strides</div><div class="ttdoc">Specifies a strides attribute to an op.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:547</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga106f069a858125ba0dd4d585b8f4e832abbb2697080b0208aeae508831718db10"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832abbb2697080b0208aeae508831718db10">dnnl_graph_op_attr_pads_begin</a></div><div class="ttdeci">@ dnnl_graph_op_attr_pads_begin</div><div class="ttdoc">Specifies a pads_begin attribute to an op.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:539</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga106f069a858125ba0dd4d585b8f4e832ae4a124e36295a9d25e39840b4de42136"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832ae4a124e36295a9d25e39840b4de42136">dnnl_graph_op_attr_dilations</a></div><div class="ttdeci">@ dnnl_graph_op_attr_dilations</div><div class="ttdoc">Specifies a dilations attribute to an op.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:525</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga106f069a858125ba0dd4d585b8f4e832ae648365c7c28fadc330a852be9e66dca"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832ae648365c7c28fadc330a852be9e66dca">dnnl_graph_op_attr_epsilon</a></div><div class="ttdeci">@ dnnl_graph_op_attr_epsilon</div><div class="ttdoc">Specifies an epsilon attribute to an op.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:495</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__op_html_gga106f069a858125ba0dd4d585b8f4e832af3d7a3b02e2abe925d6560f95086828d"><div class="ttname"><a href="group__dnnl__graph__api__op.html#gga106f069a858125ba0dd4d585b8f4e832af3d7a3b02e2abe925d6560f95086828d">dnnl_graph_op_attr_pads_end</a></div><div class="ttdeci">@ dnnl_graph_op_attr_pads_end</div><div class="ttdoc">Specifies a pads_end attribute to an op.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:541</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__partition_html_ga2a9ed01fb04bf4be25f0f955af49c784"><div class="ttname"><a href="group__dnnl__graph__api__partition.html#ga2a9ed01fb04bf4be25f0f955af49c784">dnnl_graph_partition_compile</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_partition_compile(dnnl_graph_partition_t partition, dnnl_graph_compiled_partition_t compiled_partition, size_t in_num, const dnnl_graph_logical_tensor_t **inputs, size_t out_num, const dnnl_graph_logical_tensor_t **outputs, const_dnnl_graph_engine_t engine)</div><div class="ttdoc">Compiles a partition with given input and output logical tensors.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__partition_html_ga2fdc3001503c7b586d5fc16637872ce4"><div class="ttname"><a href="group__dnnl__graph__api__partition.html#ga2fdc3001503c7b586d5fc16637872ce4">dnnl_graph_partition_t</a></div><div class="ttdeci">struct dnnl_graph_partition * dnnl_graph_partition_t</div><div class="ttdoc">A partition handle.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:277</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__partition_html_gab0ef5a8addc4e338f85b7ae7dc2c10db"><div class="ttname"><a href="group__dnnl__graph__api__partition.html#gab0ef5a8addc4e338f85b7ae7dc2c10db">dnnl_graph_partition_destroy</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_partition_destroy(dnnl_graph_partition_t partition)</div><div class="ttdoc">Destroys a partition.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__partition_html_gac2d7658a571430060e30a5b30017bce8"><div class="ttname"><a href="group__dnnl__graph__api__partition.html#gac2d7658a571430060e30a5b30017bce8">dnnl_graph_partition_create</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_partition_create(dnnl_graph_partition_t *partition)</div><div class="ttdoc">Creates a new empty partition.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__partition_html_gga7e24b277b64600ef3a83dac2e8dfa83ba1489f3f9bb1262b58fa0bf0524d883a4"><div class="ttname"><a href="group__dnnl__graph__api__partition.html#gga7e24b277b64600ef3a83dac2e8dfa83ba1489f3f9bb1262b58fa0bf0524d883a4">dnnl_graph_partition_policy_fusion</a></div><div class="ttdeci">@ dnnl_graph_partition_policy_fusion</div><div class="ttdoc">Fusion policy returns partitions with typical post-op fusions, eg.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:200</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__stream_html_ga684f4b56ffdd4df9a6b2a3dc53c75530"><div class="ttname"><a href="group__dnnl__graph__api__stream.html#ga684f4b56ffdd4df9a6b2a3dc53c75530">dnnl_graph_stream_t</a></div><div class="ttdeci">struct dnnl_graph_stream * dnnl_graph_stream_t</div><div class="ttdoc">A stream handle.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:693</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__stream_html_ga6b202d604d477ff256a88f812bb08e09"><div class="ttname"><a href="group__dnnl__graph__api__stream.html#ga6b202d604d477ff256a88f812bb08e09">dnnl_graph_stream_destroy</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_stream_destroy(dnnl_graph_stream_t stream)</div><div class="ttdoc">Destroys a stream.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__stream_html_gae61f6ea3edc15bfc89c1f1e7c347e932"><div class="ttname"><a href="group__dnnl__graph__api__stream.html#gae61f6ea3edc15bfc89c1f1e7c347e932">dnnl_graph_stream_create</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_stream_create(dnnl_graph_stream_t *stream, const_dnnl_graph_engine_t engine)</div><div class="ttdoc">Creates a stream for the specified engine.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__tensor_html_ga4035013f112e1b8c61cbc9bc935833f7"><div class="ttname"><a href="group__dnnl__graph__api__tensor.html#ga4035013f112e1b8c61cbc9bc935833f7">dnnl_graph_tensor_destroy</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_tensor_destroy(dnnl_graph_tensor_t tensor)</div><div class="ttdoc">Destroys a tensor.</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__tensor_html_ga501fef96950f38448cb326c776e8d068"><div class="ttname"><a href="group__dnnl__graph__api__tensor.html#ga501fef96950f38448cb326c776e8d068">const_dnnl_graph_tensor_t</a></div><div class="ttdeci">const struct dnnl_graph_tensor * const_dnnl_graph_tensor_t</div><div class="ttdoc">A constant tensor handle.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:682</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__tensor_html_ga77c7c6168286b2a791ecea37336d25d4"><div class="ttname"><a href="group__dnnl__graph__api__tensor.html#ga77c7c6168286b2a791ecea37336d25d4">dnnl_graph_tensor_t</a></div><div class="ttdeci">struct dnnl_graph_tensor * dnnl_graph_tensor_t</div><div class="ttdoc">A tensor handle.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:679</div></div>
<div class="ttc" id="agroup__dnnl__graph__api__tensor_html_ga9ae38e704f40efe9055b7ac1b238a697"><div class="ttname"><a href="group__dnnl__graph__api__tensor.html#ga9ae38e704f40efe9055b7ac1b238a697">dnnl_graph_tensor_create</a></div><div class="ttdeci">dnnl_graph_status_t DNNL_GRAPH_API dnnl_graph_tensor_create(dnnl_graph_tensor_t *tensor, const dnnl_graph_logical_tensor_t *logical_tensor, const_dnnl_graph_engine_t engine, void *handle)</div><div class="ttdoc">Creates a tensor with logical tensor, engine, and data handle.</div></div>
<div class="ttc" id="astructdnnl__graph__logical__tensor__t_html"><div class="ttname"><a href="structdnnl__graph__logical__tensor__t.html">dnnl_graph_logical_tensor_t</a></div><div class="ttdoc">Logical tensor.</div><div class="ttdef"><b>Definition:</b> dnnl_graph_types.h:140</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<div class="footer">
    <script>
        $('#top').prependTo($('#side-nav'));
    </script>
    <div class="footer-wrapper">
        <hr>
        <ul class="footer-links">
            <li><a href="legal_information.html">Legal information</a></li>
        </ul>
    </div>
</div>